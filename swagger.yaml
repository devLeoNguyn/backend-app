openapi: 3.0.0
info:
  title: 'Movie Backend API'
  description: "API documentation cho ·ª©ng d·ª•ng Movie Backend\n\n**üéØ N√öT \"XEM T·∫§T C·∫¢\" - H∆Ø·ªöNG D·∫™N FRONTEND:**\n\n**üì± C√°ch tri·ªÉn khai n√∫t \"Xem t·∫•t c·∫£\" cho c√°c section:**\n```javascript\n// 1. Hi·ªÉn th·ªã section ban ƒë·∫ßu (8-10 phim)\nfetch('/api/home/trending')\n\n// 2. Khi user click \"Xem t·∫•t c·∫£\" ‚Üí hi·ªÉn th·ªã t·ªëi ƒëa 20 phim  \nfetch('/api/home/trending?showAll=true')\n\n// 3. √Åp d·ª•ng cho t·∫•t c·∫£ sections:\n// - /api/home/trending?showAll=true\n// - /api/home/top-rated?showAll=true  \n// - /api/home/anime?showAll=true\n// - /api/home/vietnamese?showAll=true\n// - /api/home/sports?showAll=true\n// - /api/home/coming-soon?showAll=true\n// - /api/series/trending?showAll=true\n// - /api/series/vietnamese?showAll=true\n// - /api/series/anime?showAll=true\n// - /api/series/korean?showAll=true\n```\n\n**üöÄ C·∫¨P NH·∫¨T API CONSISTENCY v1.3.0:**\n- ‚úÖ **T·ªëi ∆∞u h√≥a API:** Lo·∫°i b·ªè duplicate endpoints  \n- ‚úÖ **Nh·∫•t qu√°n d·ªØ li·ªáu:** 1 API duy nh·∫•t cho m√†n h√¨nh chi ti·∫øt phim\n- ‚ùå **ƒê√£ X√ìA:** `/api/users/{userId}/interactions/movie/{movieId}` (tr√πng l·∫∑p)\n- ‚úÖ **S·ª¨ D·ª§NG:** `/api/movies/{id}/detail-with-interactions?userId={userId}` cho m√†n h√¨nh detail\n\n**üîÑ PHI√äN B·∫¢N ƒê√É C·∫¨P NH·∫¨T:**\n- ‚ùå ƒê√£ b·ªè JWT tokens  \n- ‚ùå ƒê√£ b·ªè authentication middleware\n- ‚úÖ S·ª≠ d·ª•ng userId ƒë∆°n gi·∫£n\n- ‚úÖ Default limit 20 cho t·∫•t c·∫£ sections\n\n**üìã FLOW AUTH M·ªöI (1 m√†n h√¨nh duy nh·∫•t):**\n1. **M√†n h√¨nh nh·∫≠p SƒêT:** User nh·∫≠p s·ªë ƒëi·ªán tho·∫°i\n2. **H·ªá th·ªëng check:** \n   - N·∫øu SƒêT ƒë√£ ƒëƒÉng k√Ω ‚Üí G·ª≠i OTP ƒëƒÉng nh·∫≠p ‚Üí Verify ‚Üí V√†o trang ch·ªß\n   - N·∫øu SƒêT ch∆∞a ƒëƒÉng k√Ω ‚Üí G·ª≠i OTP ƒëƒÉng k√Ω ‚Üí Verify ‚Üí Nh·∫≠p th√¥ng tin ‚Üí V√†o trang ch·ªß\n3. **L∆∞u userId:** Store trong AsyncStorage/localStorage ƒë·ªÉ d√πng cho c√°c API kh√°c\n\n**üì± C√ÅC B∆Ø·ªöC TH·ª∞C HI·ªÜN:**\n1. G·ªçi `/api/auth/send-otp` v·ªõi s·ªë ƒëi·ªán tho·∫°i\n2. G·ªçi `/api/auth/verify-otp` ƒë·ªÉ x√°c th·ª±c\n3. N·∫øu response c√≥ `needsRegistration: true` ‚Üí G·ªçi `/api/auth/complete-registration`\n4. N·∫øu response c√≥ `needsRegistration: false` ‚Üí ƒêƒÉng nh·∫≠p th√†nh c√¥ng, v√†o trang ch·ªß\n\n**üìÅ CLOUDFLARE IMAGES CONFIGURATION:**\n      - **Account ID:** 8396e0173865666f8dae8dd32565efca\n  - **Avatar variant:** 150x150px optimized\n  - **Image delivery:** Global CDN with auto WebP conversion\n- **Supported formats:** JPEG, PNG, GIF\n- **Max file size:** 2MB\n- **Auto cleanup:** Old avatars deleted when uploading new ones\n\n**üéØ PROFILE UPDATE API:**\n- **Endpoint:** PUT `/api/users/profile?userId={id}`\n- **Content-Type:** multipart/form-data\n- **Fields:** full_name, gender, avatar (file)\n- **Integration:** Direct S3 upload + MongoDB update\n\n**üé¨ MOVIE DETAIL SCREEN WORKFLOW:**\n```javascript\n// 1. Load movie detail (API ch√≠nh th·ª©c duy nh·∫•t)\nGET /api/movies/{id}/detail-with-interactions?userId={userId}\n// ‚Üí Tr·∫£ v·ªÅ: movie info + user interactions + UI tabs config\n\n// 2. User actions (realtime updates)\nPUT /api/ratings/movies/{id}/like        // Toggle like\nPUT /api/favorites/movies/{id}           // Toggle favorite  \nPUT /api/watching/progress/{episodeId}   // Update progress\n\n// 3. Video streaming\nGET /api/video-url/{episodeId}          // Get stream URLs\n```\n\n**‚ùå DEPRECATED:** `/api/users/{userId}/interactions/movie/{movieId}` (removed - duplicate functionality)\n"
  version: 1.3.0
  contact:
    email: your-email@example.com
servers:
  -
    url: 'http://localhost:3003'
    description: 'Development server'
  -
    url: 'https://backend-app-lou3.onrender.com'
    description: 'Production server'
tags:
  -
    name: Authentication
    description: 'C√°c API li√™n quan ƒë·∫øn x√°c th·ª±c ng∆∞·ªùi d√πng (/api/auth) - Tr·∫£ v·ªÅ userId'
  -
    name: User
    description: "C√°c API li√™n quan ƒë·∫øn th√¥ng tin ng∆∞·ªùi d√πng (/api/users) - C·∫ßn userId\n\n**üö® IMPORTANT CHANGE:** ƒê√£ X√ìA `/api/users/{userId}/interactions/movie/{movieId}` \n‚Üí S·ª≠ d·ª•ng `/api/movies/{id}/detail-with-interactions?userId={userId}` thay th·∫ø\n"
  -
    name: Movie
    description: 'C√°c API li√™n quan ƒë·∫øn phim (/api/movies)'
  -
    name: Episode
    description: 'C√°c API li√™n quan ƒë·∫øn t·∫≠p phim (/api/episodes)'
  -
    name: Favorite
    description: 'C√°c API li√™n quan ƒë·∫øn danh s√°ch y√™u th√≠ch (/api/favorites) - C·∫ßn userId'
  -
    name: Payment
    description: 'C√°c API li√™n quan ƒë·∫øn thanh to√°n (/api/payments) - C·∫ßn userId'
  -
    name: Rental
    description: 'C√°c API li√™n quan ƒë·∫øn thu√™ phim (/api/rentals) - C·∫ßn userId, PayOS integration'
  -
    name: Rating
    description: 'C√°c API li√™n quan ƒë·∫øn ƒë√°nh gi√° (/api/ratings) - C·∫ßn userId'
  -
    name: Genre
    description: 'C√°c API li√™n quan ƒë·∫øn th·ªÉ lo·∫°i phim (/api/genres)'
  -
    name: Home
    description: 'C√°c API trang ch·ªß (/api/home) - Banner, phim m·ªõi, ƒë·ªÅ xu·∫•t'
  -
    name: Series
    description: 'C√°c API cho phim b·ªô/series (/api/series) - Banner, trending, ph√¢n lo·∫°i theo qu·ªëc gia'
  -
    name: 'Video Player'
    description: 'C√°c API cho m√†n h√¨nh ph√°t video (/api/video-url, /api/watching, /api/episodes) - Stream URLs, progress tracking, interactions'
  -
    name: Episode
    description: 'C√°c API cho t·∫≠p phim (/api/episodes) - Chi ti·∫øt t·∫≠p phim'
paths:
  /api/auth/send-otp:
    post:
      tags:
        - Authentication
      summary: 'üîÑ G·ª≠i m√£ OTP (ƒêƒÉng k√Ω/ƒêƒÉng nh·∫≠p th·ªëng nh·∫•t) (Frontend)'
      description: "**üîÑ FLOW M·ªöI:** G·ª≠i m√£ OTP cho c·∫£ ƒëƒÉng k√Ω v√† ƒëƒÉng nh·∫≠p trong 1 API duy nh·∫•t.\n\n**Logic x·ª≠ l√Ω:**\n- N·∫øu s·ªë ƒëi·ªán tho·∫°i ƒë√£ t·ªìn t·∫°i ‚Üí G·ª≠i OTP ƒëƒÉng nh·∫≠p\n- N·∫øu s·ªë ƒëi·ªán tho·∫°i ch∆∞a t·ªìn t·∫°i ‚Üí G·ª≠i OTP ƒëƒÉng k√Ω\n- Frontend kh√¥ng c·∫ßn bi·∫øt user ƒë√£ ƒëƒÉng k√Ω hay ch∆∞a\n\n**ƒê·∫∑c ƒëi·ªÉm:**\n- M√£ OTP c√≥ 6 s·ªë, g·ª≠i qua SMS\n- OTP c√≥ th·ªùi h·∫°n (th∆∞·ªùng 5 ph√∫t)\n- Rate limiting: T·ªëi ƒëa 3 l·∫ßn/ph√∫t\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhoneRequest'
      responses:
        '200':
          description: 'G·ª≠i OTP th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ g·ª≠i m√£ OTP'}
                  data: {type: object, properties: {phone: {type: string, example: '0912345678'}, isExistingUser: {type: boolean, example: true, description: 'true = user ƒë√£ ƒëƒÉng k√Ω (ƒëƒÉng nh·∫≠p), false = user m·ªõi (ƒëƒÉng k√Ω)'}}}
              example:
                status: success
                message: 'ƒê√£ g·ª≠i m√£ OTP ƒëƒÉng nh·∫≠p'
                data:
                  phone: '0912345678'
                  isExistingUser: true
        '400':
          description: 'L·ªói validate s·ªë ƒëi·ªán tho·∫°i'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/auth/verify-otp:
    post:
      tags:
        - Authentication
      summary: 'üîÑ X√°c th·ª±c OTP (ƒêƒÉng k√Ω/ƒêƒÉng nh·∫≠p th·ªëng nh·∫•t) (Frontend)'
      description: "**üîÑ FLOW M·ªöI:** X√°c th·ª±c m√£ OTP cho c·∫£ ƒëƒÉng k√Ω v√† ƒëƒÉng nh·∫≠p.\n\n**Response paths:**\n1. **User ƒë√£ ƒëƒÉng k√Ω:** `needsRegistration: false` ‚Üí Frontend v√†o trang ch·ªß\n2. **User ch∆∞a ƒëƒÉng k√Ω:** `needsRegistration: true` ‚Üí Frontend chuy·ªÉn m√†n h√¨nh nh·∫≠p th√¥ng tin\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VerifyOTPRequest'
      responses:
        '200':
          description: 'X√°c th·ª±c OTP th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'X√°c th·ª±c OTP th√†nh c√¥ng'}
                  data: {type: object, properties: {needsRegistration: {type: boolean, example: false, description: 'false = ƒëƒÉng nh·∫≠p th√†nh c√¥ng, true = c·∫ßn nh·∫≠p th√¥ng tin ƒëƒÉng k√Ω'}, userId: {type: string, example: 683d7b63d0ee4aeb15a11369, description: 'Ch·ªâ c√≥ khi needsRegistration = false'}, user: {$ref: '#/components/schemas/UserInfo', description: 'Ch·ªâ c√≥ khi needsRegistration = false'}}}
              examples:
                existing_user:
                  summary: 'User ƒë√£ ƒëƒÉng k√Ω (ƒëƒÉng nh·∫≠p th√†nh c√¥ng)'
                  value: {status: success, message: 'ƒêƒÉng nh·∫≠p th√†nh c√¥ng', data: {needsRegistration: false, userId: 683d7b63d0ee4aeb15a11369, user: {_id: 683d7b63d0ee4aeb15a11369, uid: 683d7b63d0ee4aeb15a11369, full_name: 'Nguy·ªÖn VƒÉn A', email: example@gmail.com, phone: '0912345678', gender: male, avatar: 'https://example.com/avatar.jpg', is_phone_verified: true}}}
                new_user:
                  summary: 'User ch∆∞a ƒëƒÉng k√Ω (c·∫ßn nh·∫≠p th√¥ng tin)'
                  value: {status: success, message: 'X√°c th·ª±c OTP th√†nh c√¥ng, vui l√≤ng nh·∫≠p th√¥ng tin', data: {needsRegistration: true}}
        '400':
          description: 'M√£ OTP kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/auth/complete-registration:
    post:
      tags:
        - Authentication
      summary: 'üîÑ Ho√†n t·∫•t ƒëƒÉng k√Ω (Sau khi verify OTP) (Frontend)'
      description: "**üîÑ FLOW M·ªöI:** Ho√†n t·∫•t qu√° tr√¨nh ƒëƒÉng k√Ω sau khi verify OTP th√†nh c√¥ng.\n\n**Khi n√†o s·ª≠ d·ª•ng:**\n- Khi `/api/auth/verify-otp` tr·∫£ v·ªÅ `needsRegistration: true`\n- User ƒë√£ x√°c th·ª±c s·ªë ƒëi·ªán tho·∫°i, gi·ªù c·∫ßn nh·∫≠p th√¥ng tin c√° nh√¢n\n\n**‚ö†Ô∏è QUAN TR·ªåNG:**\n- Kh√¥ng c·∫ßn truy·ªÅn phone, h·ªá th·ªëng t·ª± ƒë·ªông l·∫•y t·ª´ OTP record ƒë√£ verify\n- Ph·∫£i g·ªçi trong v√≤ng 10 ph√∫t sau khi verify OTP th√†nh c√¥ng\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            example:
              full_name: 'Nguy·ªÖn VƒÉn A'
              email: example@gmail.com
              gender: male
      responses:
        '201':
          description: 'ƒêƒÉng k√Ω th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: 'L·ªói validate d·ªØ li·ªáu, email ƒë√£ t·ªìn t·∫°i, ho·∫∑c phone kh√¥ng h·ª£p l·ªá'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/auth/logout:
    post:
      tags:
        - Authentication
      summary: 'üîÑ ƒêƒÉng xu·∫•t (Frontend)'
      description: "ƒêƒÉng xu·∫•t ng∆∞·ªùi d√πng (ch·ªâ tr·∫£ v·ªÅ success message).\n\n**üì± Frontend c·∫ßn l√†m:**\n- X√≥a `userId` kh·ªèi AsyncStorage/localStorage\n- Kh√¥ng c·∫ßn g·ªçi API refresh token hay g√¨ c·∫£\n"
      responses:
        '200':
          description: 'ƒêƒÉng xu·∫•t th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒêƒÉng xu·∫•t th√†nh c√¥ng'}
  /api/users/profile:
    get:
      tags:
        - User
      summary: 'L·∫•y th√¥ng tin profile (Frontend)'
      description: "L·∫•y th√¥ng tin chi ti·∫øt c·ªßa user.\n\n**üîÑ THAY ƒê·ªîI:** Kh√¥ng c·∫ßn Bearer token, ch·ªâ c·∫ßn truy·ªÅn userId qua query params\n"
      parameters:
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
          example: 683d7b63d0ee4aeb15a11369
          description: 'ID c·ªßa user c·∫ßn l·∫•y th√¥ng tin'
      responses:
        '200':
          description: 'L·∫•y th√¥ng tin th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProfileResponse'
              example:
                status: success
                data:
                  user: {_id: 683d7b63d0ee4aeb15a11369, uid: 683d7b63d0ee4aeb15a11369, full_name: 'Nguy·ªÖn VƒÉn A', email: example@gmail.com, phone: '0912345678', gender: male, avatar: 'https://example.com/avatar.jpg', is_phone_verified: true}
        '400':
          description: 'Thi·∫øu userId ho·∫∑c userId kh√¥ng h·ª£p l·ªá'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'userId l√† b·∫Øt bu·ªôc'
        '404':
          description: 'Kh√¥ng t√¨m th·∫•y user'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'Kh√¥ng t√¨m th·∫•y user'
    put:
      tags:
        - User
      summary: 'üîÑ C·∫≠p nh·∫≠t profile (v·ªõi upload avatar) (Frontend)'
      description: "**üîÑ API ƒê√É C·∫¨P NH·∫¨T:** H·ªó tr·ª£ upload avatar tr·ª±c ti·∫øp l√™n Cloudflare Images + c·∫≠p nh·∫≠t th√¥ng tin profile.\n\n**üìã T√çNH NƒÇNG:**\n- ‚úÖ C·∫≠p nh·∫≠t h·ªç t√™n, gi·ªõi t√≠nh\n          - ‚úÖ Upload avatar l√™n Cloudflare Images (auto delete avatar c≈©)\n- ‚úÖ Validation file ·∫£nh (JPEG, PNG, GIF, max 2MB)\n- ‚úÖ Unified API: c√≥ th·ªÉ update ch·ªâ text ho·∫∑c ch·ªâ avatar ho·∫∑c c·∫£ hai\n\n**üì§ REQUEST FORMAT:**\n- **Content-Type:** `multipart/form-data` (b·∫Øt bu·ªôc)\n- **Text fields:** full_name, gender\n- **File field:** avatar (optional)\n\n**üìÅ S3 STORAGE:**\n- Path: `assets/avatar-users/{uuid}.{ext}`\n- Auto generate unique filename\n- Auto delete old avatar khi upload m·ªõi\n\n**‚ö†Ô∏è L∆ØU √ù:**\n- Phone, email KH√îNG th·ªÉ c·∫≠p nh·∫≠t qua API n√†y (readonly)\n- Avatar file: JPEG/PNG/GIF, max 2MB\n- N·∫øu kh√¥ng upload avatar ‚Üí ch·ªâ update text fields\n"
      parameters:
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
          example: 684269635fb34def3a1e28fd
          description: 'ID c·ªßa user c·∫ßn c·∫≠p nh·∫≠t'
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                  description: 'H·ªç v√† t√™n ng∆∞·ªùi d√πng'
                  example: 'ƒê·∫°t Thi·ªán'
                gender:
                  type: string
                  enum: [male, female, other]
                  description: 'Gi·ªõi t√≠nh: male=Nam, female=N·ªØ, other=Kh√°c'
                  example: male
                avatar:
                  type: string
                  format: binary
                  description: 'File ·∫£nh ƒë·∫°i di·ªán (JPEG/PNG/GIF, max 2MB)'
            encoding:
              avatar:
                contentType: 'image/jpeg, image/png, image/gif'
            examples:
              update_text_only:
                summary: 'Ch·ªâ c·∫≠p nh·∫≠t text (kh√¥ng upload avatar)'
                value:
                  full_name: 'ƒê·∫°t Thi·ªán Updated'
                  gender: male
              update_with_avatar:
                summary: 'C·∫≠p nh·∫≠t text + upload avatar'
                value:
                  full_name: 'ƒê·∫°t Thi·ªán Updated'
                  gender: male
                  avatar: '[BINARY FILE DATA]'
      responses:
        '200':
          description: '‚úÖ C·∫≠p nh·∫≠t th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProfileResponse'
              examples:
                text_only_update:
                  summary: 'C·∫≠p nh·∫≠t ch·ªâ text th√†nh c√¥ng'
                  value: {status: success, message: '‚úÖ User profile updated successfully', data: {user: {_id: 684269635fb34def3a1e28fd, uid: 684269635fb34def3a1e28fd, full_name: 'ƒê·∫°t Thi·ªán Updated', email: datthien@gmail.com, phone: '0288348192', gender: male, avatar: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/old-avatar/avatar', is_phone_verified: true}}}
                avatar_upload_success:
                  summary: 'Upload avatar + c·∫≠p nh·∫≠t text th√†nh c√¥ng'
                  value: {status: success, message: '‚úÖ User profile updated successfully', data: {user: {_id: 684269635fb34def3a1e28fd, uid: 684269635fb34def3a1e28fd, full_name: 'ƒê·∫°t Thi·ªán Updated', email: datthien@gmail.com, phone: '0288348192', gender: male, avatar: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/32c5a14e-3fa0-497a-b036-32de0cdc842a/avatar', is_phone_verified: true}}}
        '400':
          description: '‚ùå L·ªói validation ho·∫∑c file'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                missing_userId:
                  summary: 'Thi·∫øu userId'
                  value: {status: error, message: 'userId l√† b·∫Øt bu·ªôc'}
                file_too_large:
                  summary: 'File qu√° l·ªõn'
                  value: {status: error, message: 'T·ªáp qu√° l·ªõn. Ch·ªâ cho ph√©p t·ªáp nh·ªè h∆°n 2MB'}
                invalid_file_type:
                  summary: 'Lo·∫°i file kh√¥ng h·ª£p l·ªá'
                  value: {status: error, message: 'Ch·ªâ cho ph√©p file ·∫£nh (JPEG, PNG, GIF)'}
                s3_upload_error:
                  summary: 'L·ªói upload S3'
                  value: {status: error, message: 'L·ªói khi upload file l√™n S3'}
        '404':
          description: '‚ùå Kh√¥ng t√¨m th·∫•y user'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'Kh√¥ng t√¨m th·∫•y user'
        '500':
          description: '‚ùå L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'L·ªói server khi x·ª≠ l√Ω upload'
  '/api/users/{userId}/interactions/summary':
    get:
      tags:
        - User
      summary: 'üìä T·ªïng k·∫øt t∆∞∆°ng t√°c ng∆∞·ªùi d√πng [ƒê√É GI·ªÆ L·∫†I] (Frontend/Admin)'
      description: "**üìä API T·ªîNG K·∫æT:** L·∫•y th·ªëng k√™ t·ªïng quan v·ªÅ ho·∫°t ƒë·ªông t∆∞∆°ng t√°c c·ªßa user.\n\n**üö® L∆ØU √ù:** API n√†y KH√ÅC v·ªõi API ƒë√£ x√≥a:\n- ‚ùå **ƒê√£ X√ìA:** `/api/users/{userId}/interactions/movie/{movieId}` (tr√πng l·∫∑p)\n- ‚úÖ **GI·ªÆ L·∫†I:** `/api/users/{userId}/interactions/summary` (th·ªëng k√™ t·ªïng quan)\n\n**üí° Use Cases:**\n- Profile/Dashboard hi·ªÉn th·ªã th·ªëng k√™ user\n- Activity summary cho user\n- Analytics v·ªÅ engagement c·ªßa user\n\n**üîÑ WORKFLOW:**\n- D√πng cho m√†n h√¨nh Profile/Dashboard\n- KH√îNG d√πng cho m√†n h√¨nh chi ti·∫øt phim (d√πng getMovieDetailWithInteractions)\n"
      parameters:
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
          example: 683d7b63d0ee4aeb15a11369
          description: 'ID c·ªßa user c·∫ßn l·∫•y th·ªëng k√™'
      responses:
        '200':
          description: '‚úÖ L·∫•y th·ªëng k√™ th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {userId: {type: string, example: 683d7b63d0ee4aeb15a11369}, userName: {type: string, example: 'Nguy·ªÖn VƒÉn A'}, stats: {type: object, properties: {totalRatings: {type: integer, example: 25, description: 'T·ªïng s·ªë l∆∞·ª£t ƒë√°nh gi√°'}, totalLikes: {type: integer, example: 18, description: 'T·ªïng s·ªë l∆∞·ª£t th√≠ch'}, totalFavorites: {type: integer, example: 12, description: 'T·ªïng s·ªë phim y√™u th√≠ch'}, totalWatchingRecords: {type: integer, example: 45, description: 'T·ªïng s·ªë t·∫≠p ƒë√£ xem'}, completedEpisodes: {type: integer, example: 32, description: 'T·ªïng s·ªë t·∫≠p ƒë√£ ho√†n th√†nh'}, totalWatchTime: {type: integer, example: 64800, description: 'T·ªïng th·ªùi gian xem (gi√¢y)'}, totalWatchTimeFormatted: {type: string, example: '18h 0m', description: 'Th·ªùi gian xem formatted'}, avgWatchPercentage: {type: integer, example: 78, description: 'Ph·∫ßn trƒÉm xem trung b√¨nh'}}}, recentActivity: {type: array, items: {type: object, properties: {_id: {type: string, example: rating_id}, movieId: {type: string, example: movie_id}, movieTitle: {type: string, example: Spider-Man}, movieType: {type: string, example: 'Phim l·∫ª'}, poster: {type: string, example: 'https://example.com/poster.jpg'}, action: {type: string, enum: [commented, liked], example: liked}, comment: {type: string, example: 'Phim hay qu√°!', description: 'Comment c·ªßa user (c√≥ th·ªÉ null)'}, isLike: {type: boolean, example: true}, createdAt: {type: string, format: date-time, example: '2024-01-15T10:30:00Z'}}}}}}
              example:
                status: success
                data:
                  userId: 683d7b63d0ee4aeb15a11369
                  userName: 'Nguy·ªÖn VƒÉn A'
                  stats: {totalRatings: 25, totalLikes: 18, totalFavorites: 12, totalWatchingRecords: 45, completedEpisodes: 32, totalWatchTime: 64800, totalWatchTimeFormatted: '18h 0m', avgWatchPercentage: 78}
                  recentActivity: [{_id: rating123, movieId: movie456, movieTitle: 'Spider-Man: No Way Home', movieType: 'Phim l·∫ª', poster: 'https://example.com/spiderman.jpg', action: liked, comment: null, isLike: true, createdAt: '2024-01-15T10:30:00Z'}]
        '404':
          description: '‚ùå Kh√¥ng t√¨m th·∫•y user'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'Kh√¥ng t√¨m th·∫•y user'
        '500':
          description: '‚ùå L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/home/new-releases:
    get:
      tags:
        - Home
      summary: 'API Banner v√† Phim ƒë·ªÅ xu·∫•t (Frontend)'
      description: "L·∫•y danh s√°ch phim m·ªõi ra m·∫Øt cho Banner ƒë·∫ßu trang v√† danh s√°ch ·ªü d∆∞·ªõi \"Phim d√†nh cho b·∫°n\".\n\n**ƒê·∫∑c ƒëi·ªÉm:**\n- Public API (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n- Ch·ªâ l·∫•y phim c√≥ release_status = \"released\"\n- S·∫Øp x·∫øp theo ng√†y t·∫°o m·ªõi nh·∫•t\n- Tr·∫£ v·ªÅ 2 sections ri√™ng bi·ªát\n"
      parameters:
        -
          name: bannerLimit
          in: query
          required: false
          schema:
            type: integer
            default: 5
            minimum: 1
            maximum: 10
          description: 'S·ªë l∆∞·ª£ng phim trong banner list (m·∫∑c ƒë·ªãnh 5)'
          example: 3
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 6
            minimum: 1
            maximum: 12
          description: 'S·ªë l∆∞·ª£ng phim trong grid "Phim d√†nh cho b·∫°n" (m·∫∑c ƒë·ªãnh 6)'
          example: 4
        -
          name: days
          in: query
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 365
          description: 'L·∫•y phim m·ªõi trong X ng√†y g·∫ßn ƒë√¢y (m·∫∑c ƒë·ªãnh 30 ng√†y)'
          example: 15
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {banner: {type: object, properties: {title: {type: string, example: 'Phim m·ªõi ra m·∫Øt'}, type: {type: string, example: banner_list}, movies: {type: array, items: {$ref: '#/components/schemas/BannerMovie'}}}}, recommended: {type: object, properties: {title: {type: string, example: 'Phim d√†nh cho b·∫°n'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}}}
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/home/continue-watching:
    get:
      tags:
        - Home
      summary: 'API ƒêang xem (C·∫ßn userId s·∫Ω ph√°t tri·ªÉn trong t∆∞∆°ng lai) (Frontend)'
      description: "L·∫•y danh s√°ch phim ƒëang xem c·ªßa user.\n\n**üîÑ THAY ƒê·ªîI:** C·∫ßn truy·ªÅn userId qua query params thay v√¨ Bearer token\n"
      parameters:
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
          example: 683d7b63d0ee4aeb15a11369
          description: 'ID c·ªßa user c·∫ßn l·∫•y danh s√°ch ƒëang xem'
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
          example: 20
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'ƒêang xem'}, type: {type: string, example: continue_watching}, data: {type: array, items: {type: object, properties: {movieId: {type: string, example: 60d5ecb74df5e2001f8b4567}, title: {type: string, example: Avatar}, poster: {type: string, example: 'https://example.com/poster.jpg'}, progress: {type: number, example: 0.65}, lastWatchedAt: {type: string, format: date-time, example: '2023-12-01T10:30:00Z'}}}}}}
        '400':
          description: 'Thi·∫øu userId'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'userId l√† b·∫Øt bu·ªôc'
  /api/home/trending:
    get:
      tags:
        - Home
      summary: 'API Phim ƒëang th·ªãnh h√†nh (Frontend)'
      description: "L·∫•y danh s√°ch phim ƒëang th·ªãnh h√†nh (ƒë∆∞·ª£c xem nhi·ªÅu nh·∫•t).\n\n**ƒê·∫∑c ƒëi·ªÉm:**\n- Public API (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n- S·∫Øp x·∫øp theo view count\n- Format gi·ªëng GridMovie\n\n**üî• FRONTEND \"XEM T·∫§T C·∫¢\" BUTTON:**\n```javascript\n// Hi·ªÉn th·ªã section ban ƒë·∫ßu (10 phim)\nGET /api/home/trending\n\n// Khi user nh·∫•n \"Xem t·∫•t c·∫£\" ‚Üí hi·ªÉn th·ªã t·ªëi ƒëa 20 phim\nGET /api/home/trending?showAll=true\n```\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: "**üéØ N√öT \"XEM T·∫§T C·∫¢\"**\n\n- `false`: Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh (10 phim) ‚≠ê **D√†nh cho trang ch·ªß**\n- `true`: Hi·ªÉn th·ªã t·ªëi ƒëa 20 phim ‚≠ê **D√†nh cho n√∫t \"Xem t·∫•t c·∫£\"**\n"
          example: true
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 20
          description: 'S·ªë l∆∞·ª£ng phim trending (ch·ªâ √°p d·ª•ng khi showAll=true, m·∫∑c ƒë·ªãnh 20)'
          example: 20
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'Phim ƒëang th·ªãnh h√†nh'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/home/top-rated:
    get:
      tags:
        - Home
      summary: 'API Phim ƒë∆∞·ª£c ƒë√°nh gi√° cao (Frontend)'
      description: "L·∫•y danh s√°ch phim ƒë∆∞·ª£c ƒë√°nh gi√° cao nh·∫•t.\n\n**ƒê·∫∑c ƒëi·ªÉm:**\n- Public API (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n- S·∫Øp x·∫øp theo rating\n- Ch·ªâ l·∫•y phim c√≥ rating > 0\n\n**‚≠ê FRONTEND \"XEM T·∫§T C·∫¢\" BUTTON:**\n```javascript\n// Hi·ªÉn th·ªã section ban ƒë·∫ßu (8 phim)\nGET /api/home/top-rated\n\n// Khi user nh·∫•n \"Xem t·∫•t c·∫£\" ‚Üí hi·ªÉn th·ªã t·ªëi ƒëa 20 phim\nGET /api/home/top-rated?showAll=true\n```\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: "**üéØ N√öT \"XEM T·∫§T C·∫¢\"**\n\n- `false`: Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh (8 phim) ‚≠ê **D√†nh cho trang ch·ªß**\n- `true`: Hi·ªÉn th·ªã t·ªëi ƒëa 20 phim ‚≠ê **D√†nh cho n√∫t \"Xem t·∫•t c·∫£\"**\n"
          example: true
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 20
          description: 'S·ªë l∆∞·ª£ng phim top-rated (ch·ªâ √°p d·ª•ng khi showAll=true, m·∫∑c ƒë·ªãnh 20)'
          example: 20
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'Phim ƒë∆∞·ª£c ƒë√°nh gi√° cao'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/home/sports:
    get:
      tags:
        - Home
      summary: 'API S·ª± ki·ªán th·ªÉ thao (Frontend)'
      description: "L·∫•y danh s√°ch s·ª± ki·ªán th·ªÉ thao.\n\n**ƒê·∫∑c ƒëi·ªÉm:**\n- Public API (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n- Ch·ªâ l·∫•y movie_type = \"Th·ªÉ thao\"\n- Filter theo status (upcoming, released, ended)\n\n**‚öΩ FRONTEND \"XEM T·∫§T C·∫¢\" BUTTON:**\n```javascript\n// Hi·ªÉn th·ªã section ban ƒë·∫ßu (8 s·ª± ki·ªán)\nGET /api/home/sports\n\n// Khi user nh·∫•n \"Xem t·∫•t c·∫£\" ‚Üí hi·ªÉn th·ªã t·ªëi ƒëa 20 s·ª± ki·ªán\nGET /api/home/sports?showAll=true\n```\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: "**üéØ N√öT \"XEM T·∫§T C·∫¢\"**\n\n- `false`: Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh (8 s·ª± ki·ªán) ‚≠ê **D√†nh cho trang ch·ªß**\n- `true`: Hi·ªÉn th·ªã t·ªëi ƒëa 20 s·ª± ki·ªán ‚≠ê **D√†nh cho n√∫t \"Xem t·∫•t c·∫£\"**\n"
          example: true
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 20
          description: 'S·ªë l∆∞·ª£ng s·ª± ki·ªán th·ªÉ thao (ch·ªâ √°p d·ª•ng khi showAll=true, m·∫∑c ƒë·ªãnh 20)'
          example: 20
        -
          name: status
          in: query
          required: false
          schema:
            type: string
            enum:
              - upcoming
              - released
              - ended
          description: "Filter theo tr·∫°ng th√°i s·ª± ki·ªán:\n- upcoming: S·ª± ki·ªán s·∫Øp di·ªÖn ra\n- released: S·ª± ki·ªán ƒë√£ ph√°t h√†nh (m·∫∑c ƒë·ªãnh)\n- ended: S·ª± ki·ªán ƒë√£ k·∫øt th√∫c\n"
          example: released
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'S·ª± ki·ªán th·ªÉ thao'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/home/anime:
    get:
      tags:
        - Home
      summary: 'API Anime/Ho·∫°t h√¨nh hot (Frontend)'
      description: "L·∫•y danh s√°ch anime/ho·∫°t h√¨nh n·ªïi b·∫≠t v·ªõi logic ƒë·∫∑c tr∆∞ng.\n\n**Fontend s·ª≠ d·ª•ng cho:**\n- Section \"Anime hot\"\n- Grid layout ho·∫°t h√¨nh\n- Hi·ªÉn th·ªã poster anime v·ªõi t·ªâ l·ªá ƒë·∫∑c bi·ªát\n\n**üå∏ FRONTEND \"XEM T·∫§T C·∫¢\" BUTTON:**\n```javascript\n// Hi·ªÉn th·ªã section ban ƒë·∫ßu (8 anime)\nGET /api/home/anime\n\n// Khi user nh·∫•n \"Xem t·∫•t c·∫£\" ‚Üí hi·ªÉn th·ªã t·ªëi ƒëa 20 anime\nGET /api/home/anime?showAll=true\n```\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: "**üéØ N√öT \"XEM T·∫§T C·∫¢\"**\n\n- `false`: Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh (8 anime) ‚≠ê **D√†nh cho trang ch·ªß**\n- `true`: Hi·ªÉn th·ªã t·ªëi ƒëa 20 anime ‚≠ê **D√†nh cho n√∫t \"Xem t·∫•t c·∫£\"**\n"
          example: true
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 20
          description: 'S·ªë l∆∞·ª£ng anime hot (ch·ªâ √°p d·ª•ng khi showAll=true, m·∫∑c ƒë·ªãnh 20)'
          example: 20
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'Anime hot'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
              example:
                status: success
                data:
                  title: 'Anime hot'
                  type: grid
                  movies: []
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'L·ªói khi l·∫•y anime hot'
  /api/home/vietnamese:
    get:
      tags:
        - Home
      summary: 'API Phim Vi·ªát ƒë·∫∑c s·∫Øc (Frontend)'
      description: "L·∫•y danh s√°ch phim Vi·ªát Nam v·ªõi logic t√¨m ki·∫øm ƒë·∫∑c tr∆∞ng.\n\n**Logic ƒë·∫∑c tr∆∞ng:**\n- S·∫Øp x·∫øp theo rating (phim c√≥ rating cao nh·∫•t)\n- T√≠nh to√°n rating/viewCount        \n\n**Fontend s·ª≠ d·ª•ng cho:**\n- Section \"Phim Vi·ªát ƒë·∫∑c s·∫Øc\"\n- Grid layout phim Vi·ªát\n- Hi·ªÉn th·ªã poster phim Vi·ªát Nam\n\n**üáªüá≥ FRONTEND \"XEM T·∫§T C·∫¢\" BUTTON:**\n```javascript\n// Hi·ªÉn th·ªã section ban ƒë·∫ßu (8 phim Vi·ªát)\nGET /api/home/vietnamese\n\n// Khi user nh·∫•n \"Xem t·∫•t c·∫£\" ‚Üí hi·ªÉn th·ªã t·ªëi ƒëa 20 phim Vi·ªát\nGET /api/home/vietnamese?showAll=true\n```\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: "**üéØ N√öT \"XEM T·∫§T C·∫¢\"**\n\n- `false`: Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh (8 phim Vi·ªát) ‚≠ê **D√†nh cho trang ch·ªß**\n- `true`: Hi·ªÉn th·ªã t·ªëi ƒëa 20 phim Vi·ªát ‚≠ê **D√†nh cho n√∫t \"Xem t·∫•t c·∫£\"**\n"
          example: true
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 20
          description: 'S·ªë l∆∞·ª£ng phim Vi·ªát (ch·ªâ √°p d·ª•ng khi showAll=true, m·∫∑c ƒë·ªãnh 20)'
          example: 20
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'Phim Vi·ªát ƒë·∫∑c s·∫Øc'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
              example:
                status: success
                data:
                  title: 'Phim Vi·ªát ƒë·∫∑c s·∫Øc'
                  type: grid
                  movies: [{movieId: 683fb55d88e880e019875aa7, title: 'M√¨nh Y√™u Nhau, B√¨nh Y√™n Th√¥i', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/minh-yeu-nhau-binh-yen-thoi/medium', movieType: 'Phim b·ªô', producer: 'SK Pictures, VTV3'}, {movieId: 683e6774602b36157f1c7b18, title: 'G·∫∑p L·∫°i Ch·ªã B·∫ßu', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/gap-lai-chi-bau-500/medium', movieType: 'Phim l·∫ª', producer: 'CJ Entertainment Vietnam'}, {movieId: 683fb6e188e880e019875ac3, title: 'Ng√†y X∆∞a C√≥ M·ªôt Chuy·ªán T√¨nh', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/ngay-xua-co-cau-chuyen-tinh/medium', movieType: 'Phim l·∫ª', producer: 'HK Film, H√£ng phim Anh T·ªÖu'}]
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'L·ªói khi l·∫•y phim Vi·ªát'
  /api/home/coming-soon:
    get:
      tags:
        - Home
      summary: 'API Phim s·∫Øp chi·∫øu (ƒë·∫∑t l·ªãch s·∫Ω ph√°t tri·ªÉn trong t∆∞∆°ng lai) (Frontend)'
      description: "L·∫•y danh s√°ch phim s·∫Øp chi·∫øu v·ªõi logic ƒë·∫∑c tr∆∞ng.\n\n**Fontend s·ª≠ d·ª•ng cho:**\n- Section \"S·∫Øp chi·∫øu\"\n- Grid layout phim s·∫Øp chi·∫øu\n- Hi·ªÉn th·ªã poster + th√¥ng tin c∆° b·∫£n\n- C√≥ th·ªÉ th√™m countdown timer ƒë·∫øn ng√†y chi·∫øu\n\n**üîú FRONTEND \"XEM T·∫§T C·∫¢\" BUTTON:**\n```javascript\n// Hi·ªÉn th·ªã section ban ƒë·∫ßu (8 phim s·∫Øp chi·∫øu)\nGET /api/home/coming-soon\n\n// Khi user nh·∫•n \"Xem t·∫•t c·∫£\" ‚Üí hi·ªÉn th·ªã t·ªëi ƒëa 20 phim s·∫Øp chi·∫øu\nGET /api/home/coming-soon?showAll=true\n```\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: "**üéØ N√öT \"XEM T·∫§T C·∫¢\"**\n\n- `false`: Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh (8 phim) ‚≠ê **D√†nh cho trang ch·ªß**\n- `true`: Hi·ªÉn th·ªã t·ªëi ƒëa 20 phim ‚≠ê **D√†nh cho n√∫t \"Xem t·∫•t c·∫£\"**\n"
          example: true
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 20
          description: 'S·ªë l∆∞·ª£ng phim s·∫Øp chi·∫øu (ch·ªâ √°p d·ª•ng khi showAll=true, m·∫∑c ƒë·ªãnh 20)'
          example: 20
        -
          name: days
          in: query
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 365
          description: 'L·∫•y phim s·∫Øp chi·∫øu trong X ng√†y t·ªõi (m·∫∑c ƒë·ªãnh 30 ng√†y)'
          example: 15
      responses:
        '200':
          description: 'L·∫•y d·ªØ li·ªáu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'S·∫Øp chi·∫øu'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
              example:
                status: success
                data:
                  title: 'S·∫Øp chi·∫øu'
                  type: grid
                  movies: [{movieId: 683fb76c88e880e019875acb, title: 'Avatar: The Way of Water 2', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/avatar-way-of-water-2/medium', movieType: 'Phim l·∫ª', producer: '20th Century Studios'}, {movieId: 683e922d88e880e019875a1f, title: 'World Cup 2026 Final', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/world-cup-2026/medium', movieType: 'Th·ªÉ thao', producer: FIFA}]
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'L·ªói khi l·∫•y phim s·∫Øp chi·∫øu'
  /api/series/banner-series:
    get:
      tags:
        - Series
      summary: 'üé¨ API Banner v√† phim b·ªô ƒë·ªÅ xu·∫•t cho m√†n h√¨nh Series (Frontend)'
      description: "**üéØ API CHUY√äN D√ÄNH CHO M√ÄN H√åNH PHIM B·ªò**\n\n**üì∫ Tr·∫£ v·ªÅ 2 sections:**\n- ‚úÖ **Banner:** Phim b·ªô m·ªõi ra m·∫Øt (slider/banner)\n- ‚úÖ **Grid:** Phim b·ªô ƒë·ªÅ xu·∫•t d√†nh cho b·∫°n\n\n**üîß ƒê·∫∑c ƒëi·ªÉm:**\n- Ch·ªâ l·∫•y phim c√≥ `movie_type = \"Phim b·ªô\"`\n- Filter theo `release_status = \"released\"`\n- S·∫Øp x·∫øp theo ng√†y t·∫°o m·ªõi nh·∫•t\n- T·ª± ƒë·ªông format cho frontend FlatList/Grid\n\n**üì± Frontend Usage:**\n```javascript\n// L·∫•y banner + grid cho m√†n h√¨nh phim b·ªô\nfetch('/api/series/banner-series')\n\n// V·ªõi custom parameters\nfetch('/api/series/banner-series?bannerLimit=3&limit=8&days=15')\n```\n\n**üîì Public API** (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n"
      parameters:
        -
          name: bannerLimit
          in: query
          required: false
          schema:
            type: integer
            default: 5
            minimum: 1
            maximum: 10
          description: "**üé¨ S·ªê PHIM TRONG BANNER (T√πy ch·ªçn)**\n\nS·ªë l∆∞·ª£ng phim b·ªô hi·ªÉn th·ªã trong banner slider\n- M·∫∑c ƒë·ªãnh: `5` phim ‚≠ê **Khuy√™n d√πng**\n- T·ªëi ƒëa: `10` phim\n"
          example: 5
        -
          name: showAll
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: "**üéØ N√öT \"XEM T·∫§T C·∫¢\"**\n\n- `false`: Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh (6 phim b·ªô) ‚≠ê **D√†nh cho trang ch·ªß**\n- `true`: Hi·ªÉn th·ªã t·ªëi ƒëa 20 phim b·ªô ‚≠ê **D√†nh cho n√∫t \"Xem t·∫•t c·∫£\"**\n"
          example: true
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 6
            minimum: 1
            maximum: 20
          description: "**üìä S·ªê PHIM TRONG GRID (T√πy ch·ªçn)**\n\nS·ªë l∆∞·ª£ng phim b·ªô trong section \"Phim b·ªô d√†nh cho b·∫°n\"\n- M·∫∑c ƒë·ªãnh: `6` phim ‚≠ê **Khuy√™n d√πng**\n- T·ªëi ƒëa: `20` phim (khi showAll=true)\n"
          example: 6
        -
          name: days
          in: query
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 365
          description: "**üìÖ L·ªåOC PHIM B·ªò M·ªöI (T√πy ch·ªçn)**\n\nL·∫•y phim b·ªô m·ªõi trong X ng√†y g·∫ßn ƒë√¢y\n- M·∫∑c ƒë·ªãnh: `30` ng√†y ‚≠ê **Khuy√™n d√πng**\n- T·ªëi ƒëa: `365` ng√†y\n"
          example: 30
      responses:
        '200':
          description: '‚úÖ L·∫•y banner v√† phim b·ªô ƒë·ªÅ xu·∫•t th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {banner: {type: object, properties: {title: {type: string, example: 'Phim b·ªô m·ªõi ra m·∫Øt'}, type: {type: string, example: banner_list}, movies: {type: array, items: {$ref: '#/components/schemas/BannerMovie'}}}}, recommended: {type: object, properties: {title: {type: string, example: 'Phim b·ªô d√†nh cho b·∫°n'}, type: {type: string, example: grid}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}}}
              example:
                status: success
                data:
                  banner: {title: 'Phim b·ªô m·ªõi ra m·∫Øt', type: banner_list, movies: [{movieId: 683fb76c88e880e019875aca, title: '1000 Years Old', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium', description: 'B·ªô phim t√¨nh c·∫£m ƒë·∫∑c s·∫Øc t·ª´ Th√°i Lan v·ªõi c√¢u chuy·ªán t√¨nh y√™u v∆∞·ª£t th·ªùi gian...', releaseYear: 2024, movieType: 'Phim b·ªô', producer: 'WeTV Thailand', genres: ['T√¨nh c·∫£m', Drama]}]}
                  recommended: {title: 'Phim b·ªô d√†nh cho b·∫°n', type: grid, movies: [{movieId: 683fb76c88e880e019875aca, title: '1000 Years Old', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium', movieType: 'Phim b·ªô', producer: 'WeTV Thailand'}]}
        '500':
          description: '‚ùå L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'L·ªói khi l·∫•y banner phim b·ªô'
  /api/series/trending:
    get:
      tags:
        - Series
      summary: 'üî• API Phim b·ªô ƒëang th·ªãnh h√†nh (Frontend)'
      description: "**üéØ API PHIM B·ªò HOT NH·∫§T**\n\n**üî• ƒê·∫∑c ƒëi·ªÉm:**\n- Ch·ªâ l·∫•y phim c√≥ `movie_type = \"Phim b·ªô\"`\n- S·∫Øp x·∫øp theo l∆∞·ª£t xem (view_count) cao nh·∫•t\n- H·ªó tr·ª£ xem t·∫•t c·∫£ v·ªõi `showAll=true`\n- T·ª± ƒë·ªông t√≠nh to√°n rating v√† stats\n\n**üì± Frontend Usage:**\n```javascript\n// L·∫•y 8 phim b·ªô hot nh·∫•t\nfetch('/api/series/trending')\n\n// Xem t·∫•t c·∫£ phim b·ªô th·ªãnh h√†nh\nfetch('/api/series/trending?showAll=true')\n```\n\n**üîì Public API** (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: string
            enum:
              - 'true'
              - 'false'
          description: "**üëÄ XEM T·∫§T C·∫¢ (T√πy ch·ªçn)**\n\n- `true`: Xem t·∫•t c·∫£ phim b·ªô th·ªãnh h√†nh (pagination)\n- `false` ho·∫∑c kh√¥ng truy·ªÅn: Ch·ªâ 8 phim top\n\nüí° **Tip:** D√πng cho trang \"Xem t·∫•t c·∫£\"\n"
          example: 'false'
      responses:
        '200':
          description: '‚úÖ L·∫•y phim b·ªô th·ªãnh h√†nh th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'Phim b·ªô ƒëang th·ªãnh h√†nh'}, type: {type: string, example: grid}, showAll: {type: boolean, example: false}, total: {type: integer, example: 8}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
              examples:
                default_view:
                  summary: 'Xem m·∫∑c ƒë·ªãnh (8 phim b·ªô top)'
                  value: {status: success, data: {title: 'Phim b·ªô ƒëang th·ªãnh h√†nh', type: grid, showAll: false, total: 8, movies: [{movieId: 683fb76c88e880e019875aca, title: '1000 Years Old', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium', movieType: 'Phim b·ªô', producer: 'WeTV Thailand'}]}}
                show_all_view:
                  summary: 'Xem t·∫•t c·∫£ phim b·ªô th·ªãnh h√†nh'
                  value: {status: success, data: {title: 'T·∫•t c·∫£ phim b·ªô th·ªãnh h√†nh', type: grid, showAll: true, total: 45, movies: [{movieId: 683fb76c88e880e019875aca, title: '1000 Years Old', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium', movieType: 'Phim b·ªô', producer: 'WeTV Thailand'}]}}
  /api/series/vietnamese:
    get:
      tags:
        - Series
      summary: 'üáªüá≥ API Phim b·ªô Vi·ªát Nam (Frontend)'
      description: "**üéØ API PHIM B·ªò VI·ªÜT NAM ƒê·∫∂C S·∫ÆC**\n\n**üáªüá≥ ƒê·∫∑c ƒëi·ªÉm:**\n- Ch·ªâ l·∫•y phim c√≥ `movie_type = \"Phim b·ªô\"`\n- Filter producer ch·ª©a \"Vi·ªát Nam\" ho·∫∑c \"Vietnam\"\n- S·∫Øp x·∫øp theo ƒë√°nh gi√° v√† l∆∞·ª£t xem\n- H·ªó tr·ª£ xem t·∫•t c·∫£ v·ªõi `showAll=true`\n\n**üì± Frontend Usage:**\n```javascript\n// L·∫•y 8 phim b·ªô Vi·ªát hot nh·∫•t\nfetch('/api/series/vietnamese')\n\n// Xem t·∫•t c·∫£ phim b·ªô Vi·ªát\nfetch('/api/series/vietnamese?showAll=true')\n```\n\n**üîì Public API** (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: string
            enum:
              - 'true'
              - 'false'
          description: "**üëÄ XEM T·∫§T C·∫¢ PHIM B·ªò VI·ªÜT (T√πy ch·ªçn)**\n\n- `true`: Xem t·∫•t c·∫£ phim b·ªô Vi·ªát Nam\n- `false` ho·∫∑c kh√¥ng truy·ªÅn: Ch·ªâ 8 phim top\n"
          example: 'false'
      responses:
        '200':
          description: '‚úÖ L·∫•y phim b·ªô Vi·ªát Nam th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'Phim b·ªô Vi·ªát ƒë·∫∑c s·∫Øc'}, type: {type: string, example: grid}, showAll: {type: boolean, example: false}, total: {type: integer, example: 8}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
  /api/series/anime:
    get:
      tags:
        - Series
      summary: 'üéå API Phim b·ªô Anime/Ho·∫°t h√¨nh (Frontend)'
      description: "**üéØ API ANIME SERIES HOT**\n\n**üéå ƒê·∫∑c ƒëi·ªÉm:**\n- Ch·ªâ l·∫•y phim c√≥ `movie_type = \"Phim b·ªô\"`\n- Filter theo th·ªÉ lo·∫°i \"Ho·∫°t h√¨nh\" ho·∫∑c producer anime\n- S·∫Øp x·∫øp theo popularity v√† rating\n- H·ªó tr·ª£ xem t·∫•t c·∫£ v·ªõi `showAll=true`\n\n**üì± Frontend Usage:**\n```javascript\n// L·∫•y 8 anime series hot nh·∫•t\nfetch('/api/series/anime')\n\n// Xem t·∫•t c·∫£ anime series\nfetch('/api/series/anime?showAll=true')\n```\n\n**üîì Public API** (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: string
            enum:
              - 'true'
              - 'false'
          description: "**üëÄ XEM T·∫§T C·∫¢ ANIME SERIES (T√πy ch·ªçn)**\n\n- `true`: Xem t·∫•t c·∫£ anime/ho·∫°t h√¨nh b·ªô\n- `false` ho·∫∑c kh√¥ng truy·ªÅn: Ch·ªâ 8 series top\n"
          example: 'false'
      responses:
        '200':
          description: '‚úÖ L·∫•y anime series th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'Anime series hot'}, type: {type: string, example: grid}, showAll: {type: boolean, example: false}, total: {type: integer, example: 8}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
  /api/series/korean:
    get:
      tags:
        - Series
      summary: 'üá∞üá∑ API Phim b·ªô H√†n Qu·ªëc (K-Drama) (Frontend)'
      description: "**üéØ API K-DRAMA HOT NH·∫§T**\n\n**üá∞üá∑ ƒê·∫∑c ƒëi·ªÉm:**\n- Ch·ªâ l·∫•y phim c√≥ `movie_type = \"Phim b·ªô\"`\n- Filter producer ch·ª©a \"H√†n Qu·ªëc\", \"Korea\", \"KBS\", \"SBS\", \"MBC\"\n- S·∫Øp x·∫øp theo popularity v√† rating\n- H·ªó tr·ª£ xem t·∫•t c·∫£ v·ªõi `showAll=true`\n\n**üì± Frontend Usage:**\n```javascript\n// L·∫•y 8 K-drama hot nh·∫•t\nfetch('/api/series/korean')\n\n// Xem t·∫•t c·∫£ K-drama\nfetch('/api/series/korean?showAll=true')\n```\n\n**üîì Public API** (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n"
      parameters:
        -
          name: showAll
          in: query
          required: false
          schema:
            type: string
            enum:
              - 'true'
              - 'false'
          description: "**üëÄ XEM T·∫§T C·∫¢ K-DRAMA (T√πy ch·ªçn)**\n\n- `true`: Xem t·∫•t c·∫£ phim b·ªô H√†n Qu·ªëc\n- `false` ho·∫∑c kh√¥ng truy·ªÅn: Ch·ªâ 8 phim top\n"
          example: 'false'
      responses:
        '200':
          description: '‚úÖ L·∫•y K-drama th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {title: {type: string, example: 'K-Drama hot nh·∫•t'}, type: {type: string, example: grid}, showAll: {type: boolean, example: false}, total: {type: integer, example: 8}, movies: {type: array, items: {$ref: '#/components/schemas/GridMovie'}}}}
              example:
                status: success
                data:
                  title: 'K-Drama hot nh·∫•t'
                  type: grid
                  showAll: false
                  total: 8
                  movies: [{movieId: 683fb123456789abcdef1234, title: 'Hometown''s Embrace', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/hometown-embrace/medium', movieType: 'Phim b·ªô', producer: 'KBS Drama'}]
  '/api/movies/{id}/detail-with-interactions':
    get:
      tags:
        - Movie
      summary: 'üé¨ API Chi ti·∫øt phim t·ªïng h·ª£p cho m√†n h√¨nh detail [CH√çNH TH·ª®C] (Frontend)'
      description: "**üéØ M·ª•c ƒë√≠ch:** API t·ªïng h·ª£p m·ªçi th√¥ng tin c·∫ßn thi·∫øt cho m√†n h√¨nh chi ti·∫øt phim.\n\n**üöÄ API CH√çNH TH·ª®C DUY NH·∫§T:** ƒê√¢y l√† API CH√çNH TH·ª®C v√† DUY NH·∫§T cho m√†n h√¨nh chi ti·∫øt phim.\n\n**‚ùå ƒê√É X√ìA API C≈®:** `/api/users/{userId}/interactions/movie/{movieId}` (tr√πng l·∫∑p)\n**‚úÖ S·ª¨ D·ª§NG API N√ÄY:** T·∫•t c·∫£ d·ªØ li·ªáu user interactions ƒë√£ ƒë∆∞·ª£c t√≠ch h·ª£p v√†o ƒë√¢y.\n\n**üåü ƒê·∫∑c ƒëi·ªÉm:**\n- ‚úÖ API hybrid: Public (kh√¥ng c·∫ßn userId) ho·∫∑c Protected (c√≥ userId)\n- ‚úÖ Kh√¥ng c√≥ userId: Ch·ªâ th√¥ng tin phim + stats + comments\n- ‚úÖ C√≥ userId: Th√™m user interactions (like, favorite, watching progress)\n- ‚úÖ Tr·∫£ v·ªÅ c·∫•u h√¨nh tabs cho UI (Danh s√°ch/Li√™n quan)\n- ‚úÖ Th√¥ng tin kh√°c nhau cho phim l·∫ª vs phim b·ªô\n\n**üí° Use Cases:**\n- M√†n h√¨nh chi ti·∫øt phim (user ch∆∞a ƒëƒÉng nh·∫≠p)\n- M√†n h√¨nh chi ti·∫øt phim (user ƒë√£ ƒëƒÉng nh·∫≠p) - c√≥ tr·∫°ng th√°i t∆∞∆°ng t√°c\n- UI render tabs d·ª±a v√†o `tabs` config\n\n**üîÑ THAY ƒê·ªîI:** S·ª≠ d·ª•ng userId thay v√¨ Authorization header\n"
      parameters:
        -
          name: id
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
          description: 'ID c·ªßa phim (ObjectId)'
        -
          name: userId
          in: query
          schema:
            type: string
          example: 683d7b63d0ee4aeb15a11369
          description: 'ID c·ªßa user (t√πy ch·ªçn) - c√≥ userId th√¨ tr·∫£ v·ªÅ user interactions'
      responses:
        '200':
          description: '‚úÖ L·∫•y chi ti·∫øt phim th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {$ref: '#/components/schemas/MovieDetailResponse'}
              examples:
                phim_bo_with_user:
                  summary: 'Phim b·ªô - C√≥ userId (ƒëƒÉng nh·∫≠p)'
                  value: {status: success, data: {movie: {_id: 675a1234567890abcdef1234, movie_title: 'H·ªì S∆° Trinh S√°t II - T·∫≠p 1', description: 'B·ªô phim trinh th√°m Hong Kong n·ªïi ti·∫øng...', production_time: '1995-12-15T00:00:00.000Z', producer: 'TVB Hong Kong', poster_path: 'https://example.com/poster.jpg', genres: [{_id: genre1, genre_name: 'Trinh th√°m', description: 'Phim trinh th√°m'}], movie_type: 'Phim b·ªô', price: 0, is_free: true, price_display: 'Mi·ªÖn ph√≠', episodes: [{_id: ep1, episode_number: 1, episode_title: 'T·∫≠p 1', episode_description: 'T·∫≠p m·ªü ƒë·∫ßu', duration: 45, uri: 'https://cdn.example.com/episode1.m3u8', is_locked: false}]}, stats: {views: 15420, viewsFormatted: 15.4K, likes: 892, rating: 4.6, totalRatings: 1250, comments: 156}, recentComments: [{_id: comment1, user: {name: 'B√¨nh Lu·∫≠n', email: user@example.com}, comment: '2 s√©p n√™n ƒë·ªôc th√¢n l√† ok nh·∫•t', isLike: true, createdAt: '2024-12-11T12:00:00.000Z'}], userInteractions: {hasLiked: true, hasRated: true, userComment: 'Phim hay qu√°!', isFavorite: true, isFollowing: true, watchingProgress: {episodeNumber: 1, watchPercentage: 75.5, currentTime: 2040, lastWatched: '2024-12-11T10:30:00.000Z'}}, relatedMovies: [{movieId: 675a1234567890abcdef5678, title: 'H·ªì S∆° Trinh S√°t I', poster: 'https://example.com/related1.jpg', movieType: 'Phim b·ªô', producer: 'TVB Hong Kong'}], tabs: {showEpisodesList: true, showRelated: true}}}
                phim_le_no_user:
                  summary: 'Phim l·∫ª - Kh√¥ng c√≥ userId (ch∆∞a ƒëƒÉng nh·∫≠p)'
                  value: {status: success, data: {movie: {_id: 675a1234567890abcdef9999, movie_title: 'Spider-Man: No Way Home', description: 'B·ªô phim si√™u anh h√πng...', production_time: '2021-12-15T00:00:00.000Z', producer: 'Sony Pictures', poster_path: 'https://example.com/spiderman.jpg', genres: [{_id: genre2, genre_name: 'H√†nh ƒë·ªông', description: 'Phim h√†nh ƒë·ªông'}], movie_type: 'Phim l·∫ª', price: 50000, is_free: false, price_display: '50,000 VNƒê', uri: null, duration: 148, is_locked: true}, stats: {views: 125340, viewsFormatted: 125K, likes: 8934, rating: 4.8, totalRatings: 12450, comments: 2156}, recentComments: [], userInteractions: null, relatedMovies: [], tabs: {showEpisodesList: false, showRelated: true}}}
        '404':
          description: '‚ùå Kh√¥ng t√¨m th·∫•y phim'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'Kh√¥ng t√¨m th·∫•y phim'
        '500':
          description: '‚ùå L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'L·ªói khi l·∫•y chi ti·∫øt phim'
  /api/genres:
    get:
      tags:
        - Genre
      summary: 'L·∫•y danh s√°ch th·ªÉ lo·∫°i (Frontend/Admin)'
      description: "L·∫•y danh s√°ch th·ªÉ lo·∫°i v·ªõi nhi·ªÅu options.\n\n**Query Parameters:**\n- `type`: Lo·∫°i th·ªÉ lo·∫°i c·∫ßn l·∫•y ('all' | 'parent' | 'active' | 'children', m·∫∑c ƒë·ªãnh: 'all')\n- `parent_id`: ID th·ªÉ lo·∫°i cha (ch·ªâ d√πng khi type='children')\n\n**L∆∞u √Ω:**\n- Lu√¥n tr·∫£ v·ªÅ poster (include_poster=true)\n- Lu√¥n tr·∫£ v·ªÅ d·∫°ng c√¢y (format=tree)\n\n**V√≠ d·ª•:**\n1. L·∫•y t·∫•t c·∫£ th·ªÉ lo·∫°i:\n   GET /api/genres\n2. L·∫•y th·ªÉ lo·∫°i cha:\n   GET /api/genres?type=parent\n3. L·∫•y th·ªÉ lo·∫°i con c·ªßa m·ªôt th·ªÉ lo·∫°i cha:\n   GET /api/genres?type=children&parent_id=123\n"
      parameters:
        -
          in: query
          name: type
          schema:
            type: string
            enum:
              - all
              - parent
              - active
              - children
            default: all
          description: 'Lo·∫°i th·ªÉ lo·∫°i c·∫ßn l·∫•y'
        -
          in: query
          name: parent_id
          schema:
            type: string
          description: 'ID th·ªÉ lo·∫°i cha (ch·ªâ d√πng khi type=''children'')'
      responses:
        '200':
          description: 'Th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {genres: {type: array, items: {$ref: '#/components/schemas/Genre'}}, total: {type: integer, example: 10}, type: {type: string, example: all}, format: {type: string, example: tree}}}
        '404':
          description: 'Kh√¥ng t√¨m th·∫•y th·ªÉ lo·∫°i'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/genres/{id}/movies':
    get:
      tags:
        - Genre
      summary: 'L·∫•y danh s√°ch phim c·ªßa th·ªÉ lo·∫°i'
      description: "L·∫•y danh s√°ch phim thu·ªôc m·ªôt th·ªÉ lo·∫°i c·ª• th·ªÉ.\n\n**Query Parameters:**\n- `include_children`: C√≥ l·∫•y phim t·ª´ th·ªÉ lo·∫°i con kh√¥ng (m·∫∑c ƒë·ªãnh: false)\n- `page`: S·ªë trang (m·∫∑c ƒë·ªãnh: 1)\n- `limit`: S·ªë phim m·ªói trang (m·∫∑c ƒë·ªãnh: 10)\n- `sort`: C√°ch s·∫Øp x·∫øp (m·∫∑c ƒë·ªãnh: -createdAt)\n\n**V√≠ d·ª•:**\n```\nGET /api/genres/6847d080101e640d01a0c37f/movies?include_children=true&page=1&limit=10&sort=-createdAt\n```\n"
      parameters:
        -
          name: id
          in: query
          description: 'ID c·ªßa th·ªÉ lo·∫°i'
          required: true
          schema:
            type: string
            pattern: '^[0-9a-fA-F]{24}$'
            example: 6847d080101e640d01a0c37f
        -
          name: include_children
          in: query
          description: 'C√≥ l·∫•y phim t·ª´ th·ªÉ lo·∫°i con kh√¥ng'
          required: false
          schema:
            type: boolean
            default: false
        -
          name: page
          in: query
          description: 'S·ªë trang'
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
        -
          name: limit
          in: query
          description: 'S·ªë phim m·ªói trang'
          required: false
          schema:
            type: integer
            default: 10
            minimum: 1
        -
          name: sort
          in: query
          description: 'C√°ch s·∫Øp x·∫øp (-createdAt, -view_count, etc.)'
          required: false
          schema:
            type: string
            default: '-createdAt'
      responses:
        '200':
          description: 'Th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {movies: {type: array, items: {$ref: '#/components/schemas/MovieListItem'}}, pagination: {type: object, properties: {total: {type: integer, example: 50}, page: {type: integer, example: 1}, totalPages: {type: integer, example: 5}, limit: {type: integer, example: 10}}}}}
        '404':
          description: 'Kh√¥ng t√¨m th·∫•y th·ªÉ lo·∫°i'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: error}
                  message: {type: string, example: 'Kh√¥ng t√¨m th·∫•y th·ªÉ lo·∫°i'}
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: error}
                  message: {type: string, example: 'L·ªói khi l·∫•y danh s√°ch phim c·ªßa th·ªÉ lo·∫°i'}
                  error: {type: string}
  '/api/genres/{id}':
    put:
      tags:
        - Genre
      summary: 'C·∫≠p nh·∫≠t th·ªÉ lo·∫°i (Admin)'
      description: 'C·∫≠p nh·∫≠t th√¥ng tin c·ªßa m·ªôt th·ªÉ lo·∫°i'
      parameters:
        -
          in: query
          name: id
          required: true
          schema:
            type: string
          description: 'ID th·ªÉ lo·∫°i'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                genre_name:
                  type: string
                  example: 'H√†nh ƒë·ªông'
                description:
                  type: string
                  example: 'Phim h√†nh ƒë·ªông gay c·∫•n'
                poster:
                  type: string
                  example: 'https://example.com/poster.jpg'
                sort_order:
                  type: integer
                  example: 1
      responses:
        '200':
          description: 'C·∫≠p nh·∫≠t th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ c·∫≠p nh·∫≠t th·ªÉ lo·∫°i th√†nh c√¥ng'}
                  data: {type: object, properties: {genre: {$ref: '#/components/schemas/Genre'}}}
    delete:
      tags:
        - Genre
      summary: 'X√≥a th·ªÉ lo·∫°i (Admin)'
      description: 'X√≥a m·ªôt th·ªÉ lo·∫°i'
      parameters:
        -
          in: query
          name: id
          required: true
          schema:
            type: string
          description: 'ID th·ªÉ lo·∫°i'
      responses:
        '200':
          description: 'X√≥a th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ x√≥a th·ªÉ lo·∫°i th√†nh c√¥ng'}
  '/api/genres/{id}/status':
    put:
      tags:
        - Genre
      summary: 'C·∫≠p nh·∫≠t tr·∫°ng th√°i th·ªÉ lo·∫°i (Admin)'
      description: "C·∫≠p nh·∫≠t tr·∫°ng th√°i c·ªßa th·ªÉ lo·∫°i (activate/deactivate/toggle).\n\n**L∆∞u √Ω:**\n- N·∫øu kh√¥ng truy·ªÅn action ‚Üí Toggle tr·∫°ng th√°i\n- N·∫øu truy·ªÅn action ‚Üí Set tr·∫°ng th√°i theo action\n"
      parameters:
        -
          in: query
          name: id
          required: true
          schema:
            type: string
          description: 'ID th·ªÉ lo·∫°i'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  type: string
                  enum: [activate, deactivate]
                  example: activate
      responses:
        '200':
          description: 'C·∫≠p nh·∫≠t th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ c·∫≠p nh·∫≠t tr·∫°ng th√°i th·ªÉ lo·∫°i th√†nh c√¥ng'}
                  data: {type: object, properties: {genre: {$ref: '#/components/schemas/Genre'}}}
  '/api/ratings/movies/{movie_id}/like':
    put:
      tags:
        - 'Movie Interactions'
      summary: '‚ö° Toggle Th√≠ch/B·ªè th√≠ch phim (UNIFIED) (Frontend)'
      description: "**üÜï API M·ªöI - RESTful Toggle Approach**\n\n**üéØ M·ª•c ƒë√≠ch:** Toggle tr·∫°ng th√°i like/unlike phim trong 1 API duy nh·∫•t.\n\n**‚úÖ ∆Øu ƒëi·ªÉm:**\n- Gi·∫£m duplicate code t·ª´ 2 APIs xu·ªëng 1 API\n- RESTful v√† semantic h∆°n (PUT cho update)\n- D·ªÖ implement ·ªü frontend (1 function thay v√¨ 2)\n- Response nh·∫•t qu√°n cho c·∫£ like v√† unlike\n\n**üí° C√°ch d√πng:**\n```javascript\n// Like phim\nPUT /api/ratings/movies/{movie_id}/like\n{ \"isLike\": true, \"userId\": \"xxx\" }\n\n// Unlike phim  \nPUT /api/ratings/movies/{movie_id}/like\n{ \"isLike\": false, \"userId\": \"xxx\" }\n```\n"
      parameters:
        -
          name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
          description: 'ID c·ªßa phim'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - isLike
              properties:
                userId:
                  type: string
                  example: 683d7b63d0ee4aeb15a11369
                  description: 'ID c·ªßa user th·ª±c hi·ªán thao t√°c'
                isLike:
                  type: boolean
                  example: true
                  description: 'true = th√≠ch phim, false = b·ªè th√≠ch phim'
      responses:
        '200':
          description: '‚úÖ Toggle like/unlike th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ th√≠ch phim'}
                  data: {type: object, properties: {movieId: {type: string, example: 675a1234567890abcdef1234}, isLike: {type: boolean, example: true, description: 'Tr·∫°ng th√°i hi·ªán t·∫°i'}, likeCount: {type: integer, example: 893, description: 'T·ªïng s·ªë like c·ªßa phim'}, userRating: {type: object, nullable: true, description: 'Th√¥ng tin rating c·ªßa user (null n·∫øu ƒë√£ unlike ho√†n to√†n)', properties: {_id: {type: string}, isLike: {type: boolean}, hasComment: {type: boolean}, createdAt: {type: string, format: date-time}, updatedAt: {type: string, format: date-time}}}}}
        '400':
          description: '‚ùå L·ªói validate request'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: '‚ùå Kh√¥ng t√¨m th·∫•y phim'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/ratings/movies/{movie_id}/like-legacy':
    post:
      tags:
        - 'Movie Interactions'
      summary: '‚ù§Ô∏è Th√≠ch phim (LEGACY) (Frontend)'
      description: "**‚ö†Ô∏è LEGACY API - S·ª≠ d·ª•ng API PUT m·ªõi ƒë∆∞·ª£c khuy·∫øn ngh·ªã**\n\n**üéØ M·ª•c ƒë√≠ch:** User th√≠ch m·ªôt b·ªô phim.\n\n**üîÑ THAY ƒê·ªîI:** S·ª≠ d·ª•ng userId trong body thay v√¨ Authorization header\n"
      parameters:
        -
          name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
          description: 'ID c·ªßa phim'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: 683d7b63d0ee4aeb15a11369
                  description: 'ID c·ªßa user th·ª±c hi·ªán thao t√°c'
      responses:
        '200':
          description: '‚úÖ Th√≠ch phim th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ th√≠ch phim th√†nh c√¥ng'}
                  data: {type: object, properties: {movieId: {type: string, example: 675a1234567890abcdef1234}, likeCount: {type: integer, example: 893}, rating: {type: number, format: float, example: 4.6}}}
        '404':
          description: '‚ùå Kh√¥ng t√¨m th·∫•y phim'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/ratings/movies/{movie_id}/unlike':
    post:
      tags:
        - 'Movie Interactions'
      summary: 'üíî B·ªè th√≠ch phim (Frontend)'
      description: "**üéØ M·ª•c ƒë√≠ch:** User b·ªè th√≠ch m·ªôt b·ªô phim.\n\n**üîÑ THAY ƒê·ªîI:** S·ª≠ d·ª•ng userId trong body thay v√¨ Authorization header\n"
      parameters:
        -
          name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
          description: 'ID c·ªßa phim'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: 683d7b63d0ee4aeb15a11369
                  description: 'ID c·ªßa user th·ª±c hi·ªán thao t√°c'
      responses:
        '200':
          description: '‚úÖ B·ªè th√≠ch phim th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ b·ªè th√≠ch phim th√†nh c√¥ng'}
                  data: {type: object, properties: {movieId: {type: string, example: 675a1234567890abcdef1234}, likeCount: {type: integer, example: 891}, rating: {type: number, format: float, example: 4.5}}}
  '/api/ratings/movies/{movie_id}/comment':
    post:
      tags:
        - 'Movie Interactions'
      summary: 'üí¨ Th√™m b√¨nh lu·∫≠n phim (Frontend)'
      description: "**üéØ M·ª•c ƒë√≠ch:** User th√™m b√¨nh lu·∫≠n cho m·ªôt b·ªô phim.\n\n**üîÑ THAY ƒê·ªîI:** S·ª≠ d·ª•ng userId trong body thay v√¨ Authorization header\n"
      parameters:
        -
          name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
          description: 'ID c·ªßa phim'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - comment
              properties:
                userId:
                  type: string
                  example: 683d7b63d0ee4aeb15a11369
                  description: 'ID c·ªßa user th·ª±c hi·ªán thao t√°c'
                comment:
                  type: string
                  example: 'Phim hay qu√°! Di·ªÖn vi√™n di·ªÖn r·∫•t t·ª± nhi√™n.'
                  description: 'N·ªôi dung b√¨nh lu·∫≠n'
      responses:
        '200':
          description: '‚úÖ Th√™m b√¨nh lu·∫≠n th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ th√™m b√¨nh lu·∫≠n th√†nh c√¥ng'}
                  data: {type: object, properties: {movieId: {type: string, example: 675a1234567890abcdef1234}, comment: {type: object, properties: {id: {type: string, example: rating123}, comment: {type: string, example: 'Phim hay qu√°! Di·ªÖn vi√™n di·ªÖn r·∫•t t·ª± nhi√™n.'}, user: {$ref: '#/components/schemas/UserInfo'}, createdAt: {type: string, format: date-time, example: '2024-12-11T12:00:00.000Z'}}}}}
        '400':
          description: '‚ùå B√¨nh lu·∫≠n kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/favorites/movies/{movie_id}/add':
    post:
      tags:
        - 'Movie Interactions'
      summary: '‚≠ê Th√™m v√†o danh s√°ch y√™u th√≠ch (Frontend)'
      description: "**üéØ M·ª•c ƒë√≠ch:** User th√™m phim v√†o danh s√°ch y√™u th√≠ch.\n\n**üîÑ THAY ƒê·ªîI:** S·ª≠ d·ª•ng userId trong body thay v√¨ Authorization header\n"
      parameters:
        -
          name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
          description: 'ID c·ªßa phim'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: 683d7b63d0ee4aeb15a11369
                  description: 'ID c·ªßa user th·ª±c hi·ªán thao t√°c'
      responses:
        '200':
          description: '‚úÖ Th√™m v√†o y√™u th√≠ch th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ th√™m v√†o danh s√°ch y√™u th√≠ch'}
  '/api/favorites/movies/{movie_id}/remove':
    post:
      tags:
        - 'Movie Interactions'
      summary: '‚ùå X√≥a kh·ªèi danh s√°ch y√™u th√≠ch (Frontend)'
      description: "**üéØ M·ª•c ƒë√≠ch:** User x√≥a phim kh·ªèi danh s√°ch y√™u th√≠ch.\n\n**üîÑ THAY ƒê·ªîI:** S·ª≠ d·ª•ng userId trong body thay v√¨ Authorization header\n"
      parameters:
        -
          name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
          description: 'ID c·ªßa phim'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: 683d7b63d0ee4aeb15a11369
                  description: 'ID c·ªßa user th·ª±c hi·ªán thao t√°c'
      responses:
        '200':
          description: '‚úÖ X√≥a kh·ªèi y√™u th√≠ch th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  message: {type: string, example: 'ƒê√£ x√≥a kh·ªèi danh s√°ch y√™u th√≠ch'}
  /api/movies/search:
    get:
      tags:
        - Movie
      summary: 'üîç T√¨m ki·∫øm phim ƒë∆°n gi·∫£n theo t√™n v√† m√¥ t·∫£ (Frontend)'
      description: "**üéØ API T√åM KI·∫æM PHIM ƒê∆†N GI·∫¢N**\n\n**üìö C√ÅCH D√ôNG ƒê·ªöN GI·∫¢N NH·∫§T:**\n```javascript\n// 1. T√¨m t·∫•t c·∫£ phim (kh√¥ng c·∫ßn tham s·ªë)\nGET /api/movies/search\n\n// 2. T√¨m theo t·ª´ kh√≥a trong t√™n v√† m√¥ t·∫£\nGET /api/movies/search?tuKhoa=avatar\n\n// 3. L·∫•y th√™m phim (pagination)\nGET /api/movies/search?page=2&limit=20\n```\n\n**üîß T√çNH NƒÇNG:**\n- ‚úÖ **T√¨m ki·∫øm ƒë∆°n gi·∫£n:** CH·ªà trong t√™n phim v√† m√¥ t·∫£\n- ‚úÖ **Pagination t·ª± ƒë·ªông:** h·ªó tr·ª£ infinite scroll\n- ‚úÖ **Response t·ªëi ∆∞u:** poster, stats, pricing info\n- ‚úÖ **S·∫Øp x·∫øp m·∫∑c ƒë·ªãnh:** theo ng√†y t·∫°o m·ªõi nh·∫•t\n\n**üì± FRONTEND EXAMPLES:**\n```javascript\n// T√¨m ki·∫øm c∆° b·∫£n\nfetch('/api/movies/search?tuKhoa=batman')\n\n// Load more cho FlatList\nfetch('/api/movies/search?tuKhoa=batman&page=2&limit=20')\n\n// L·∫•y t·∫•t c·∫£ phim\nfetch('/api/movies/search?page=1&limit=20')\n```\n\n**üéØ PERFECT FOR:**\n- Search screens v·ªõi FlatList/Grid\n- Simple movie search\n- Infinite scroll implementation\n\n**üîì Public API** (kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p)\n"
      parameters:
        -
          name: tuKhoa
          in: query
          required: false
          schema:
            type: string
          description: "**üî§ T·ª™ KH√ìA T√åM KI·∫æM (T√πy ch·ªçn)**\n\nT√¨m ki·∫øm ƒë∆°n gi·∫£n ch·ªâ trong:\n- üé¨ T√™n phim \n- üìù M√¥ t·∫£ phim\n\nüí° **Tips:** Kh√¥ng ph√¢n bi·ªát hoa th∆∞·ªùng, c√≥ th·ªÉ t√¨m ti·∫øng Vi·ªát c√≥ d·∫•u\n"
          example: batman
        -
          name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
          description: "**üìÑ TRANG HI·ªÜN T·∫†I (T√πy ch·ªçn)**\n\nD√πng cho infinite scroll trong FlatList\n- Trang ƒë·∫ßu: `1` (m·∫∑c ƒë·ªãnh)\n- Load more: `2`, `3`, `4`...\n"
          example: 1
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          description: "**üìä S·ªê PHIM M·ªñI TRANG (T√πy ch·ªçn)**\n\n- M·∫∑c ƒë·ªãnh: `20` phim ‚≠ê **Khuy√™n d√πng**\n- T·ªëi thi·ªÉu: `1` phim\n- T·ªëi ƒëa: `100` phim\n\nüí° **FlatList tip:** D√πng 20 cho performance t·ªët\n"
          example: 20
      responses:
        '200':
          description: '‚úÖ T√¨m ki·∫øm phim th√†nh c√¥ng'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {movies: {type: array, items: {$ref: '#/components/schemas/SearchMovieResult'}}, pagination: {$ref: '#/components/schemas/PaginationInfo'}, search_info: {$ref: '#/components/schemas/SearchInfo'}}}
              examples:
                basic_search:
                  summary: 'T√¨m ki·∫øm c∆° b·∫£n v·ªõi pagination'
                  value: {status: success, data: {movies: [{movieId: 683fb76c88e880e019875aca, title: '1000 Years Old', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium', movieType: 'Phim b·ªô', producer: 'WeTV Thailand', description: 'B·ªô phim t√¨nh c·∫£m ƒë·∫∑c s·∫Øc t·ª´ Th√°i Lan v·ªõi c√¢u chuy·ªán t√¨nh y√™u v∆∞·ª£t th·ªùi gian...', releaseYear: 2024, price: 0, is_free: true, price_display: 'Mi·ªÖn ph√≠', view_count: 15420, favorite_count: 892, rating: 4.6, total_ratings: 1250, total_episodes: 12, genres: ['T√¨nh c·∫£m', Drama]}, {movieId: 683fb76c88e880e019875acb, title: 'Avatar: The Way of Water 2', poster: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/avatar-way-of-water-2/medium', movieType: 'Phim l·∫ª', producer: '20th Century Studios', description: 'Ph·∫ßn ti·∫øp theo ƒë·∫ßy m√†u s·∫Øc c·ªßa bom t·∫•n Avatar v·ªõi nh·ªØng c·∫£nh quay d∆∞·ªõi n∆∞·ªõc...', releaseYear: 2025, price: 50000, is_free: false, price_display: '50,000 VNƒê', view_count: 89342, favorite_count: 5234, rating: 4.8, total_ratings: 8934, total_episodes: 1, genres: ['H√†nh ƒë·ªông', 'Khoa h·ªçc vi·ªÖn t∆∞·ªüng', 'Phi√™u l∆∞u']}], pagination: {current_page: 1, total_pages: 5, total_items: 89, items_per_page: 20, has_next: true, has_prev: false}, search_info: {keyword: avatar, search_in: [movie_title, description], total_found: 89}}}
                simple_search:
                  summary: 'T√¨m ki·∫øm ƒë∆°n gi·∫£n'
                  value: {status: success, data: {movies: [{movieId: 683fb76c88e880e019875acc, title: Inception, poster: 'https://example.com/inception.jpg', movieType: 'Phim l·∫ª', producer: 'Warner Bros', description: 'B·ªô phim khoa h·ªçc vi·ªÖn t∆∞·ªüng v·ªÅ gi·∫•c m∆° v√† th·ª±c t·∫°i ƒëan xen...', releaseYear: 2010, price: 0, is_free: true, price_display: 'Mi·ªÖn ph√≠', view_count: 234567, favorite_count: 12345, rating: 4.9, total_ratings: 15678, total_episodes: 1, genres: ['Khoa h·ªçc vi·ªÖn t∆∞·ªüng', 'H√†nh ƒë·ªông']}], pagination: {current_page: 2, total_pages: 3, total_items: 42, items_per_page: 20, has_next: true, has_prev: true}, search_info: {keyword: dream, search_in: [movie_title, description], total_found: 42}}}
        '500':
          description: 'L·ªói server'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                status: error
                message: 'L·ªói server khi t√¨m ki·∫øm phim'
  '/api/video-url/{videoId}':
    get:
      tags:
        - 'Video Player'
      summary: 'üé¨ API ch√≠nh l·∫•y Stream URL cho Expo Video Player (Frontend)'
      operationId: getVideoStreamUrl
      description: "**üéØ API QUAN TR·ªåNG NH·∫§T CHO VIDEO PLAYER**\n\nL·∫•y Cloudflare Stream URLs ƒë·ªÉ ph√°t video trong Expo app.\n"
      parameters:
        -
          name: videoId
          in: query
          required: true
          schema:
            type: string
          description: 'Episode ID ho·∫∑c Movie ID'
          example: 675a1234567890abcdef1234
        -
          name: type
          in: query
          required: false
          schema:
            type: string
            enum:
              - auto
              - episode
              - movie
            default: auto
          description: 'Lo·∫°i t√¨m ki·∫øm (t·ª± ƒë·ªông detect)'
        -
          name: quality
          in: query
          required: false
          schema:
            type: string
            enum:
              - auto
              - 360p
              - 480p
              - 720p
            default: auto
          description: 'Ch·∫•t l∆∞·ª£ng video'
      responses:
        '200':
          description: 'L·∫•y stream URLs th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VideoStreamResponse'
        '202':
          description: 'Video ƒëang ƒë∆∞·ª£c x·ª≠ l√Ω'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 'Video y√™u c·∫ßu thanh to√°n'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 'Video kh√¥ng t·ªìn t·∫°i'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/video-url/{videoId}/refresh':
    post:
      tags:
        - 'Video Streaming'
      summary: 'üîÑ Refresh Stream URL (Frontend)'
      operationId: refreshVideoStreamUrl
      description: 'L√†m m·ªõi Stream URL v·ªõi th·ªùi gian h·∫øt h·∫°n m·ªõi'
      parameters:
        -
          name: videoId
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
      responses:
        '200':
          description: 'URL ƒë√£ ƒë∆∞·ª£c l√†m m·ªõi'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VideoStreamResponse'
        '404':
          description: 'Video kh√¥ng t·ªìn t·∫°i'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/video-url/{videoId}/status':
    get:
      tags:
        - 'Video Streaming'
      summary: 'üìä Check Video Status (Frontend/Admin)'
      operationId: getVideoStatus
      description: 'Ki·ªÉm tra tr·∫°ng th√°i video v√† kh·∫£ nƒÉng truy c·∫≠p'
      parameters:
        -
          name: videoId
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
      responses:
        '200':
          description: 'Th√¥ng tin tr·∫°ng th√°i video'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {videoId: {type: string}, streamUid: {type: string}, available: {type: boolean}, accessible: {type: boolean}, message: {type: string}}}
        '404':
          description: 'Video kh√¥ng t·ªìn t·∫°i'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/upload/image:
    post:
      tags:
        - Upload
      summary: 'üñºÔ∏è Upload Image to Cloudflare Images (Admin)'
      operationId: uploadImage
      description: 'Upload ·∫£nh l√™n Cloudflare Images v·ªõi auto-optimization'
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: 'Image file (JPEG/PNG/GIF/WebP, max 5MB)'
                folder:
                  type: string
                  default: general
                  description: 'Folder name for organization'
                variant:
                  type: string
                  enum: [avatar, thumbnail, medium, public]
                  default: public
                  description: 'Image variant for optimization'
      responses:
        '200':
          description: 'Image uploaded successfully'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CloudflareImageResponse'
        '400':
          description: 'File kh√¥ng h·ª£p l·ªá'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/upload/video:
    post:
      tags:
        - Upload
      summary: 'üé¨ Upload Video to Cloudflare Stream (Admin)'
      operationId: uploadVideo
      description: 'Upload video l√™n Cloudflare Stream v·ªõi auto-processing'
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
                - episodeId
              properties:
                file:
                  type: string
                  format: binary
                  description: 'Video file (MP4/AVI/MOV/WebM/MKV/FLV, max 500MB)'
                episodeId:
                  type: string
                  description: 'Episode ID ƒë·ªÉ li√™n k·∫øt video'
                movieTitle:
                  type: string
                  description: 'T√™n phim (optional)'
                episodeTitle:
                  type: string
                  description: 'T√™n t·∫≠p phim (optional)'
      responses:
        '200':
          description: 'Video uploaded v√† ƒëang x·ª≠ l√Ω'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CloudflareVideoUploadResponse'
        '400':
          description: 'File kh√¥ng h·ª£p l·ªá'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/watching/progress/{episodeId}':
    get:
      tags:
        - 'Video Player'
      summary: 'üìä API l·∫•y ti·∫øn ƒë·ªô xem ƒë√£ l∆∞u (Frontend)'
      operationId: getWatchingProgress
      description: 'L·∫•y ti·∫øn ƒë·ªô xem ƒë√£ l∆∞u ƒë·ªÉ resume video t·ª´ v·ªã tr√≠ ƒë√£ xem'
      parameters:
        -
          name: episodeId
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
          description: 'User ID ƒë·ªÉ l·∫•y progress c√° nh√¢n'
          example: 675a1234567890abcdef1234
      responses:
        '200':
          description: 'Ti·∫øn ƒë·ªô xem ƒë√£ l∆∞u'
          content:
            application/json:
              schema:
                type: object
                properties:
                  episode_id: {type: string}
                  current_time: {type: number, example: 1250, description: 'V·ªã tr√≠ ƒë√£ xem (gi√¢y)'}
                  duration: {type: number, example: 1800}
                  completed: {type: boolean, example: false}
                  watch_percentage: {type: number, example: 69.4}
                  last_watched: {type: string, format: date-time}
        '404':
          description: 'Kh√¥ng t√¨m th·∫•y progress'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      tags:
        - 'Video Player'
      summary: 'üíæ API l∆∞u ti·∫øn ƒë·ªô xem (Frontend)'
      operationId: saveWatchingProgress
      description: 'L∆∞u ti·∫øn ƒë·ªô xem hi·ªán t·∫°i c·ªßa user ƒë·ªÉ c√≥ th·ªÉ resume sau'
      parameters:
        -
          name: episodeId
          in: query
          required: true
          schema:
            type: string
          example: 675a1234567890abcdef1234
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - currentTime
                - duration
              properties:
                userId:
                  type: string
                  description: 'User ID'
                currentTime:
                  type: number
                  description: 'V·ªã tr√≠ hi·ªán t·∫°i (gi√¢y)'
                duration:
                  type: number
                  description: 'T·ªïng th·ªùi l∆∞·ª£ng video (gi√¢y)'
                completed:
                  type: boolean
                  description: 'ƒê√£ xem xong hay ch∆∞a'
      responses:
        '200':
          description: 'L∆∞u progress th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
        '400':
          description: 'D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/watching/history:
    get:
      tags:
        - 'Video Player'
      summary: 'üì∫ L·∫•y l·ªãch s·ª≠ xem phim (Frontend)'
      operationId: getWatchingHistory
      description: 'L·∫•y danh s√°ch phim/episode user ƒë√£ xem g·∫ßn ƒë√¢y'
      parameters:
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
          description: 'User ID'
          example: 675a1234567890abcdef1234
        -
          name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
          description: 'S·ªë l∆∞·ª£ng items t·ªëi ƒëa'
      responses:
        '200':
          description: 'L·ªãch s·ª≠ xem phim'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: array, items: {type: object, properties: {episode_id: {type: string}, movie: {type: object}, episode: {type: object}, current_time: {type: number}, duration: {type: number}, watch_percentage: {type: number}, last_watched: {type: string, format: date-time}}}}
        '400':
          description: 'UserId kh√¥ng h·ª£p l·ªá'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/episodes/{id}':
    get:
      tags:
        - Episode
      summary: 'üì∫ Chi ti·∫øt Episode (Frontend)'
      operationId: getEpisodeDetail
      description: 'L·∫•y th√¥ng tin chi ti·∫øt c·ªßa m·ªôt episode'
      parameters:
        -
          name: id
          in: query
          required: true
          schema:
            type: string
          description: 'Episode ID'
          example: 675a1234567890abcdef1234
        -
          name: userId
          in: query
          required: false
          schema:
            type: string
          description: 'User ID ƒë·ªÉ l·∫•y progress v√† interactions'
      responses:
        '200':
          description: 'Chi ti·∫øt episode'
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: {type: string, example: success}
                  data: {type: object, properties: {episode: {type: object, properties: {_id: {type: string}, episode_title: {type: string, example: 'T·∫≠p 1: Kh·ªüi ƒë·∫ßu'}, episode_number: {type: integer, example: 1}, description: {type: string}, duration: {type: number, example: 1800}, uri: {type: string, nullable: true}, streamUid: {type: string, nullable: true}}}, movie: {type: object, description: 'Th√¥ng tin phim ch·ª©a episode n√†y'}, userProgress: {type: object, nullable: true, description: 'Ti·∫øn ƒë·ªô xem c·ªßa user (n·∫øu c√≥ userId)'}}}
        '404':
          description: 'Episode kh√¥ng t·ªìn t·∫°i'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/rentals/rent:
    post:
      tags:
        - Rental
      summary: 'üé¨ T·∫°o order thu√™ phim (PayOS)'
      description: "**üéØ T·∫°o order thu√™ phim v·ªõi t√≠ch h·ª£p PayOS.**\n\n**Pricing Logic:**\n- G√≥i 48h: 30% gi√° phim\n- G√≥i 30d: 50% gi√° phim\n\n**Flow:**\n1. Validate user v√† movie t·ªìn t·∫°i\n2. Ki·ªÉm tra user ch∆∞a thu√™ phim n√†y (active rental)\n3. T·∫°o PayOS payment link\n4. L∆∞u payment record v·ªõi status PENDING\n5. Tr·∫£ v·ªÅ QR code v√† checkout URL\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateRentalRequest'
      responses:
        '201':
          description: 'T·∫°o order thu√™ phim th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateRentalResponse'
        '400':
          description: 'Validation error ho·∫∑c user ƒë√£ thu√™ phim'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 'User ho·∫∑c Movie kh√¥ng t·ªìn t·∫°i'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /api/rentals/confirm-payment:
    post:
      tags:
        - Rental
      summary: 'üîê X√°c nh·∫≠n thanh to√°n (PayOS webhook/manual)'
      description: "**üîê X√°c nh·∫≠n thanh to√°n v√† k√≠ch ho·∫°t rental.**\n\n**Logic:**\n1. Ki·ªÉm tra payment t·ªìn t·∫°i v√† thu·ªôc v·ªÅ user\n2. Verify payment status t·ª´ PayOS\n3. C·∫≠p nh·∫≠t payment status th√†nh SUCCESS\n4. T·∫°o rental record v·ªõi th·ªùi gian b·∫Øt ƒë·∫ßu\n5. Tr·∫£ v·ªÅ th√¥ng tin rental\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConfirmPaymentRequest'
      responses:
        '200':
          description: 'X√°c nh·∫≠n thanh to√°n th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConfirmPaymentResponse'
        '400':
          description: 'ƒê∆°n h√†ng kh√¥ng t·ªìn t·∫°i ho·∫∑c ch∆∞a thanh to√°n'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  '/api/rentals/status/{movieId}':
    get:
      tags:
        - Rental
      summary: 'üì± Ki·ªÉm tra quy·ªÅn xem phim'
      description: "**üì± Ki·ªÉm tra user c√≥ quy·ªÅn xem phim hay kh√¥ng.**\n\n**Return data:**\n- `hasAccess`: boolean - c√≥ quy·ªÅn xem kh√¥ng\n- `rental`: object - th√¥ng tin rental (n·∫øu c√≥)\n- `remainingTime`: number - milliseconds c√≤n l·∫°i\n- `remainingHours/Days`: number - th·ªùi gian c√≤n l·∫°i formatted\n- `message`: string - th√¥ng b√°o cho user\n"
      parameters:
        -
          name: movieId
          in: query
          required: true
          schema:
            type: string
            example: 683d94d3602b36157f1c7af3
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
            example: 507f1f77bcf86cd799439011
      responses:
        '200':
          description: 'Ki·ªÉm tra quy·ªÅn xem th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RentalAccessResponse'
  /api/rentals/history:
    get:
      tags:
        - Rental
      summary: 'üìú L·ªãch s·ª≠ thu√™ phim c·ªßa user'
      description: "**üìú L·∫•y danh s√°ch l·ªãch s·ª≠ thu√™ phim v·ªõi pagination.**\n\n**Filters:**\n- `status`: active, expired, cancelled\n- `rentalType`: 48h, 30d\n- `page`: trang hi·ªán t·∫°i (default: 1)\n- `limit`: s·ªë item per page (default: 10)\n"
      parameters:
        -
          name: userId
          in: query
          required: true
          schema:
            type: string
          example: 507f1f77bcf86cd799439011
        -
          name: page
          in: query
          schema:
            type: integer
            default: 1
        -
          name: limit
          in: query
          schema:
            type: integer
            default: 10
        -
          name: status
          in: query
          schema:
            type: string
            enum:
              - active
              - expired
              - cancelled
        -
          name: rentalType
          in: query
          schema:
            type: string
            enum:
              - 48h
              - 30d
      responses:
        '200':
          description: 'L·∫•y l·ªãch s·ª≠ thu√™ phim th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RentalHistoryResponse'
  '/api/rentals/{rentalId}/cancel':
    put:
      tags:
        - Rental
      summary: '‚ùå H·ªßy rental'
      description: "**‚ùå H·ªßy rental c·ªßa user (ch·ªâ trong v√≤ng 24h ƒë·∫ßu).**\n"
      parameters:
        -
          name: rentalId
          in: query
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
      responses:
        '200':
          description: 'H·ªßy rental th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
  /api/rentals/stats/revenue:
    get:
      tags:
        - Rental
      summary: 'üìä Th·ªëng k√™ doanh thu (Admin)'
      description: "**üìä L·∫•y th·ªëng k√™ doanh thu theo kho·∫£ng th·ªùi gian.**\n"
      parameters:
        -
          name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
          example: '2024-01-01'
        -
          name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
          example: '2024-12-31'
      responses:
        '200':
          description: 'L·∫•y th·ªëng k√™ doanh thu th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RevenueStatsResponse'
  /api/rentals/stats/popular:
    get:
      tags:
        - Rental
      summary: 'üî• Phim ƒë∆∞·ª£c thu√™ nhi·ªÅu nh·∫•t (Admin)'
      description: "**üî• L·∫•y danh s√°ch phim ƒë∆∞·ª£c thu√™ nhi·ªÅu nh·∫•t.**\n"
      parameters:
        -
          name: limit
          in: query
          schema:
            type: integer
            default: 10
      responses:
        '200':
          description: 'L·∫•y danh s√°ch phim ph·ªï bi·∫øn th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PopularRentalsResponse'
  /api/rentals/cron/status:
    get:
      tags:
        - Rental
      summary: '‚öôÔ∏è Tr·∫°ng th√°i cron jobs (Admin)'
      description: "**‚öôÔ∏è L·∫•y tr·∫°ng th√°i t·∫•t c·∫£ cron jobs.**\n"
      responses:
        '200':
          description: 'L·∫•y tr·∫°ng th√°i cron jobs th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CronStatusResponse'
  /api/rentals/cron/manual-check:
    post:
      tags:
        - Rental
      summary: 'üîÑ Ch·∫°y manual check (Admin)'
      description: "**üîÑ Ch·∫°y manual check rental expiration ngay l·∫≠p t·ª©c.**\n"
      responses:
        '200':
          description: 'Manual check ho√†n th√†nh'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ManualCheckResponse'
  '/api/rentals/cron/{action}/{jobName}':
    put:
      tags:
        - Rental
      summary: 'üéõÔ∏è Control cron job (Admin)'
      description: "**üéõÔ∏è Start/Stop m·ªôt cron job c·ª• th·ªÉ.**\n\n**Available jobs:**\n- `expiredRentalsCheck`\n- `expiringNotifications`\n- `cleanupOldRentals`\n- `dailyStatsGeneration`\n"
      parameters:
        -
          name: action
          in: query
          required: true
          schema:
            type: string
            enum:
              - start
              - stop
        -
          name: jobName
          in: query
          required: true
          schema:
            type: string
            enum:
              - expiredRentalsCheck
              - expiringNotifications
              - cleanupOldRentals
              - dailyStatsGeneration
      responses:
        '200':
          description: 'Control cron job th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
  /api/rentals/webhook/payment-success:
    post:
      tags:
        - Rental
      summary: 'üîó PayOS webhook (PayOS only)'
      description: "**üîó Webhook t·ª´ PayOS khi thanh to√°n th√†nh c√¥ng.**\n\n**‚ö†Ô∏è Ch·ªâ PayOS ƒë∆∞·ª£c ph√©p g·ªçi endpoint n√†y.**\n"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                orderCode:
                  type: string
                status:
                  type: string
                amount:
                  type: number
      responses:
        '200':
          description: 'Webhook x·ª≠ l√Ω th√†nh c√¥ng'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'
components:
  schemas:
    MovieListItem:
      type: object
      description: 'Schema cho phim trong danh s√°ch'
      properties:
        _id:
          type: string
          example: 683fb76c88e880e019875aca
          description: 'ID c·ªßa phim'
        movie_title:
          type: string
          example: '1000 Years Old'
          description: 'T√™n phim'
        description:
          type: string
          example: 'B·ªô phim t√¨nh c·∫£m ƒë·∫∑c s·∫Øc t·ª´ Th√°i Lan...'
          description: 'M√¥ t·∫£ phim'
        poster_path:
          type: string
          example: 'https://imagedelivery.net/.../poster.jpg'
          description: 'URL poster phim'
        genres:
          type: array
          items:
            type: object
            properties:
              _id:
                type: string
              genre_name:
                type: string
          description: 'Danh s√°ch th·ªÉ lo·∫°i'
        producer:
          type: string
          example: 'WeTV Thailand'
          description: 'Nh√† s·∫£n xu·∫•t'
        price:
          type: number
          example: 0
          description: 'Gi√° phim'
        createdAt:
          type: string
          format: date-time
          description: 'Th·ªùi gian t·∫°o'
    PhoneRequest:
      type: object
      required:
        - phone
      properties:
        phone:
          type: string
          example: '0912345678'
          description: "S·ªë ƒëi·ªán tho·∫°i c·ªßa ng∆∞·ªùi d√πng\n- Format: 0xxxxxxxxx ho·∫∑c +84xxxxxxxxx\n- Ph·∫£i l√† s·ªë ƒëi·ªán tho·∫°i Vi·ªát Nam h·ª£p l·ªá\n- Kh√¥ng ƒë∆∞·ª£c ch·ª©a k√Ω t·ª± ƒë·∫∑c bi·ªát ho·∫∑c kho·∫£ng tr·∫Øng\n"
    VerifyOTPRequest:
      type: object
      required:
        - phone
        - otp
      properties:
        phone:
          type: string
          example: '0912345678'
          description: 'S·ªë ƒëi·ªán tho·∫°i ƒë√£ d√πng ƒë·ªÉ nh·∫≠n OTP'
        otp:
          type: string
          example: '123456'
          description: 'M√£ OTP 6 s·ªë nh·∫≠n ƒë∆∞·ª£c qua SMS'
    RegisterRequest:
      type: object
      required:
        - full_name
        - email
        - gender
      properties:
        full_name:
          type: string
          example: 'Nguy·ªÖn VƒÉn A'
          description: 'H·ªç v√† t√™n ng∆∞·ªùi d√πng'
        email:
          type: string
          format: email
          example: example@gmail.com
          description: 'Email ng∆∞·ªùi d√πng (ph·∫£i l√† email h·ª£p l·ªá v√† ch∆∞a ƒë∆∞·ª£c s·ª≠ d·ª•ng)'
        gender:
          type: string
          enum:
            - male
            - female
          example: male
          description: 'Gi·ªõi t√≠nh (male = Nam, female = N·ªØ)'
    UpdateProfileRequest:
      type: object
      description: 'üîÑ Schema for multipart/form-data profile update with avatar upload'
      properties:
        full_name:
          type: string
          example: 'ƒê·∫°t Thi·ªán'
          description: 'H·ªç v√† t√™n ng∆∞·ªùi d√πng (c√≥ th·ªÉ update)'
        gender:
          type: string
          enum:
            - male
            - female
            - other
          example: male
          description: 'Gi·ªõi t√≠nh (male=Nam, female=N·ªØ, other=Kh√°c) - c√≥ th·ªÉ update'
        avatar:
          type: string
          format: binary
          description: 'File ·∫£nh ƒë·∫°i di·ªán (JPEG/PNG/GIF, max 2MB)'
      additionalProperties: false
      example:
        full_name: 'ƒê·∫°t Thi·ªán Updated'
        gender: male
        avatar: '[BINARY_FILE_DATA]'
    UpdateProfileTextOnlyRequest:
      type: object
      description: 'Schema for text-only profile update (no avatar)'
      properties:
        full_name:
          type: string
          example: 'ƒê·∫°t Thi·ªán'
          description: 'H·ªç v√† t√™n ng∆∞·ªùi d√πng'
        gender:
          type: string
          enum:
            - male
            - female
            - other
          example: male
          description: 'Gi·ªõi t√≠nh (male=Nam, female=N·ªØ, other=Kh√°c)'
      additionalProperties: false
    AuthResponse:
      type: object
      properties:
        status:
          type: string
          example: success
        message:
          type: string
          example: 'ƒêƒÉng nh·∫≠p th√†nh c√¥ng'
        data:
          type: object
          properties:
            userId:
              type: string
              example: 683d7b63d0ee4aeb15a11369
              description: '‚ö†Ô∏è L∆ØU L·∫†I C√ÅI N√ÄY! D√πng cho t·∫•t c·∫£ APIs c·∫ßn authentication'
            user:
              $ref: '#/components/schemas/UserInfo'
          description: 'Kh√¥ng c√≤n tr·∫£ v·ªÅ tokens n·ªØa, ch·ªâ c√≥ userId v√† user info'
    ProfileResponse:
      type: object
      properties:
        status:
          type: string
          example: success
        message:
          type: string
          example: 'L·∫•y th√¥ng tin th√†nh c√¥ng'
        data:
          type: object
          properties:
            user:
              $ref: '#/components/schemas/UserInfo'
    UserInfo:
      type: object
      properties:
        _id:
          type: string
          example: 683d7b63d0ee4aeb15a11369
        uid:
          type: string
          example: 683d7b63d0ee4aeb15a11369
          description: 'UID ƒë·ªÉ hi·ªÉn th·ªã tr√™n m√†n h√¨nh (gi·ªëng _id)'
        full_name:
          type: string
          example: 'Nguy·ªÖn VƒÉn A'
        email:
          type: string
          example: example@gmail.com
        phone:
          type: string
          example: '0912345678'
        gender:
          type: string
          enum:
            - male
            - female
            - other
          example: male
          description: 'Gi·ªõi t√≠nh: male=Nam, female=N·ªØ, other=Kh√°c'
        avatar:
          type: string
          example: 'https://example.com/avatar.jpg'
        is_phone_verified:
          type: boolean
          example: true
    SuccessResponse:
      type: object
      properties:
        status:
          type: string
          example: success
        message:
          type: string
    ErrorResponse:
      type: object
      properties:
        status:
          type: string
          example: error
        message:
          type: string
    BannerMovie:
      type: object
      description: 'Schema cho phim trong banner section'
      properties:
        movieId:
          type: string
          example: 683fb76c88e880e019875aca
          description: 'ID c·ªßa phim'
        title:
          type: string
          example: '1000 Years Old'
          description: 'T√™n phim'
        poster:
          type: string
          example: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium'
          description: 'URL poster phim'
        description:
          type: string
          nullable: true
          example: 'Phim l·∫ª Vi·ªát Nam d·ª±a tr√™n truy·ªán d√†i c√πng t√™n c·ªßa Nguy·ªÖn Nh·∫≠t √Ånh...'
          description: 'M√¥ t·∫£ phim (c√≥ th·ªÉ null)'
        releaseYear:
          type: integer
          nullable: true
          example: 2024
          description: 'NƒÉm ph√°t h√†nh (c√≥ th·ªÉ null)'
        movieType:
          type: string
          example: 'Phim b·ªô'
          description: 'Lo·∫°i phim (Phim b·ªô, Phim l·∫ª, Th·ªÉ thao)'
        producer:
          type: string
          example: 'WeTV Thailand'
          description: 'Nh√† s·∫£n xu·∫•t'
        genres:
          type: array
          items:
            type: string
          example:
            - 'T√¨nh c·∫£m'
            - 'Kinh d·ªã'
          description: 'Danh s√°ch th·ªÉ lo·∫°i (t·ªëi ƒëa 3)'
    HomeCategoryItem:
      type: object
      description: 'Schema cho th·ªÉ lo·∫°i cha trong trang ch·ªß'
      properties:
        _id:
          type: string
          example: 6847d080101e640d01a0c37f
          description: 'ID duy nh·∫•t c·ªßa th·ªÉ lo·∫°i'
        title:
          type: string
          example: 'Ho·∫°t h√¨nh'
          description: 'T√™n th·ªÉ lo·∫°i hi·ªÉn th·ªã'
        description:
          type: string
          example: 'Phim ho·∫°t h√¨nh, anime v√† phim ƒë·ªông'
          description: 'M√¥ t·∫£ th·ªÉ lo·∫°i'
        poster:
          type: string
          example: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop'
          description: 'URL h√¨nh ·∫£nh poster cho th·ªÉ lo·∫°i'
        movie_count:
          type: integer
          example: 9
          description: 'T·ªïng s·ªë phim thu·ªôc th·ªÉ lo·∫°i (bao g·ªìm c·∫£ con)'
        has_children:
          type: boolean
          example: true
          description: 'C√≥ th·ªÉ lo·∫°i con hay kh√¥ng'
        children_count:
          type: integer
          example: 4
          description: 'S·ªë l∆∞·ª£ng th·ªÉ lo·∫°i con'
        sort_order:
          type: integer
          example: 1
          description: 'Th·ª© t·ª± s·∫Øp x·∫øp'
    GenreInfo:
      type: object
      description: 'Schema th√¥ng tin c∆° b·∫£n c·ªßa th·ªÉ lo·∫°i'
      properties:
        _id:
          type: string
          example: 6847d080101e640d01a0c37f
          description: 'ID c·ªßa th·ªÉ lo·∫°i'
        genre_name:
          type: string
          example: 'Ho·∫°t h√¨nh'
          description: 'T√™n th·ªÉ lo·∫°i'
        description:
          type: string
          example: 'Phim ho·∫°t h√¨nh, anime v√† phim ƒë·ªông'
          description: 'M√¥ t·∫£ th·ªÉ lo·∫°i'
    ChildGenreItem:
      type: object
      description: 'Schema cho th·ªÉ lo·∫°i con'
      properties:
        _id:
          type: string
          example: 683d7d1dd0ee4aeb15a1138c
          description: 'ID c·ªßa th·ªÉ lo·∫°i con'
        genre_name:
          type: string
          example: 'H√†nh ƒê·ªông'
          description: 'T√™n th·ªÉ lo·∫°i con'
        description:
          type: string
          example: 'Phim h√†nh ƒë·ªông, v√µ thu·∫≠t'
          description: 'M√¥ t·∫£ th·ªÉ lo·∫°i con'
        movie_count:
          type: integer
          example: 24
          description: 'S·ªë l∆∞·ª£ng phim thu·ªôc th·ªÉ lo·∫°i con'
        sort_order:
          type: integer
          example: 1
          description: 'Th·ª© t·ª± s·∫Øp x·∫øp'
    GridMovie:
      type: object
      description: 'Schema cho phim trong grid section'
      properties:
        movieId:
          type: string
          example: 683fb76c88e880e019875aca
          description: 'ID c·ªßa phim'
        title:
          type: string
          example: '1000 Years Old'
          description: 'T√™n phim'
        poster:
          type: string
          example: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium'
          description: 'URL poster phim'
        movieType:
          type: string
          example: 'Phim b·ªô'
          description: 'Lo·∫°i phim (Phim b·ªô, Phim l·∫ª, Th·ªÉ thao)'
        producer:
          type: string
          example: 'WeTV Thailand'
          description: 'Nh√† s·∫£n xu·∫•t'
    MovieDetailResponse:
      type: object
      description: 'Schema response chi ti·∫øt phim t·ªïng h·ª£p cho m√†n h√¨nh detail'
      properties:
        movie:
          type: object
          description: 'Th√¥ng tin chi ti·∫øt phim'
          properties:
            _id:
              type: string
              example: 675a1234567890abcdef1234
            movie_title:
              type: string
              example: 'H·ªì S∆° Trinh S√°t II - T·∫≠p 1'
            description:
              type: string
              example: 'B·ªô phim trinh th√°m Hong Kong n·ªïi ti·∫øng...'
            production_time:
              type: string
              format: date-time
              example: '1995-12-15T00:00:00.000Z'
            producer:
              type: string
              example: 'TVB Hong Kong'
            poster_path:
              type: string
              example: 'https://example.com/poster.jpg'
            genres:
              type: array
              items:
                type: object
                properties:
                  _id: {type: string}
                  genre_name: {type: string}
                  description: {type: string}
            movie_type:
              type: string
              enum:
                - 'Phim b·ªô'
                - 'Phim l·∫ª'
                - 'Th·ªÉ thao'
              example: 'Phim b·ªô'
            price:
              type: number
              example: 0
            is_free:
              type: boolean
              example: true
            price_display:
              type: string
              example: 'Mi·ªÖn ph√≠'
            episodes:
              type: array
              description: 'Danh s√°ch t·∫≠p (ch·ªâ c√≥ khi l√† phim b·ªô)'
              items:
                type: object
                properties:
                  _id: {type: string}
                  episode_number: {type: integer}
                  episode_title: {type: string}
                  episode_description: {type: string}
                  duration: {type: integer}
                  uri: {type: string, nullable: true}
                  is_locked: {type: boolean}
            uri:
              type: string
              nullable: true
              description: 'Video URL (ch·ªâ c√≥ khi l√† phim l·∫ª)'
            duration:
              type: integer
              description: 'Th·ªùi l∆∞·ª£ng phim l·∫ª (ph√∫t)'
            is_locked:
              type: boolean
              description: 'Phim c√≥ b·ªã kh√≥a kh√¥ng'
        stats:
          type: object
          description: 'Th·ªëng k√™ phim'
          properties:
            views:
              type: integer
              example: 15420
            viewsFormatted:
              type: string
              example: 15.4K
            likes:
              type: integer
              example: 892
            rating:
              type: number
              format: float
              example: 4.6
            totalRatings:
              type: integer
              example: 1250
            comments:
              type: integer
              example: 156
        recentComments:
          type: array
          description: '5 b√¨nh lu·∫≠n g·∫ßn ƒë√¢y nh·∫•t'
          items:
            type: object
            properties:
              _id:
                type: string
              user:
                type: object
                properties:
                  name: {type: string}
                  email: {type: string}
              comment:
                type: string
              isLike:
                type: boolean
              createdAt:
                type: string
                format: date-time
        userInteractions:
          type: object
          nullable: true
          description: 'T∆∞∆°ng t√°c c·ªßa user (null n·∫øu ch∆∞a ƒëƒÉng nh·∫≠p)'
          properties:
            hasLiked:
              type: boolean
              example: true
              description: 'User ƒë√£ like phim ch∆∞a'
            hasRated:
              type: boolean
              example: true
              description: 'User ƒë√£ rate phim ch∆∞a'
            userComment:
              type: string
              nullable: true
              example: 'Phim hay qu√°!'
              description: 'B√¨nh lu·∫≠n c·ªßa user'
            isFavorite:
              type: boolean
              example: true
              description: 'ƒê√£ th√™m v√†o y√™u th√≠ch ch∆∞a'
            isFollowing:
              type: boolean
              example: true
              description: 'ƒê√£ theo d√µi phim ch∆∞a (gi·ªëng isFavorite)'
            watchingProgress:
              type: object
              nullable: true
              description: 'Ti·∫øn ƒë·ªô xem phim'
              properties:
                episodeNumber:
                  type: integer
                  example: 1
                watchPercentage:
                  type: number
                  example: 75.5
                currentTime:
                  type: integer
                  example: 2040
                lastWatched:
                  type: string
                  format: date-time
                  example: '2024-12-11T10:30:00.000Z'
        relatedMovies:
          type: array
          description: 'Phim li√™n quan cho tab "Li√™n quan"'
          items:
            type: object
            properties:
              movieId:
                type: string
                example: 675a1234567890abcdef5678
              title:
                type: string
                example: 'H·ªì S∆° Trinh S√°t I'
              poster:
                type: string
                example: 'https://example.com/related1.jpg'
              movieType:
                type: string
                example: 'Phim b·ªô'
              producer:
                type: string
                example: 'TVB Hong Kong'
        tabs:
          type: object
          description: 'C·∫•u h√¨nh tabs cho UI'
          properties:
            showEpisodesList:
              type: boolean
              example: true
              description: 'true = hi·ªán tab ''Danh s√°ch'' (ch·ªâ phim b·ªô c√≥ true)'
            showRelated:
              type: boolean
              example: true
              description: 'true = hi·ªán tab ''Li√™n quan'' (lu√¥n lu√¥n true)'
    Genre:
      type: object
      properties:
        _id:
          type: string
          example: 683d7b63d0ee4aeb15a11369
        genre_name:
          type: string
          example: 'H√†nh ƒë·ªông'
        description:
          type: string
          example: 'Phim h√†nh ƒë·ªông gay c·∫•n'
        poster:
          type: string
          example: 'https://example.com/poster.jpg'
        parent_genre:
          type: string
          nullable: true
          example: 683d7b63d0ee4aeb15a11369
        is_parent:
          type: boolean
          example: true
        is_active:
          type: boolean
          example: true
        sort_order:
          type: integer
          example: 1
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
    SearchMovieResult:
      type: object
      description: 'üîç Schema phim t·ªëi ∆∞u cho Search Results + FlatList'
      properties:
        movieId:
          type: string
          example: 683fb76c88e880e019875aca
          description: 'ID c·ªßa phim'
        title:
          type: string
          example: '1000 Years Old'
          description: 'T√™n phim'
        poster:
          type: string
          nullable: true
          example: 'https://imagedelivery.net/8396e0173865666f8dae8dd32565efca/phimbo-1000-years-old/medium'
          description: 'URL poster phim'
        movieType:
          type: string
          enum:
            - 'Phim b·ªô'
            - 'Phim l·∫ª'
            - 'Th·ªÉ thao'
          example: 'Phim b·ªô'
          description: 'Lo·∫°i phim'
        producer:
          type: string
          example: 'WeTV Thailand'
          description: 'Nh√† s·∫£n xu·∫•t'
        description:
          type: string
          nullable: true
          example: 'B·ªô phim t√¨nh c·∫£m ƒë·∫∑c s·∫Øc t·ª´ Th√°i Lan v·ªõi c√¢u chuy·ªán t√¨nh y√™u v∆∞·ª£t th·ªùi gian...'
          description: 'M√¥ t·∫£ ng·∫Øn phim (100 k√Ω t·ª±)'
        releaseYear:
          type: integer
          nullable: true
          example: 2024
          description: 'NƒÉm ph√°t h√†nh'
        price:
          type: number
          example: 0
          description: 'Gi√° phim (VNƒê)'
        is_free:
          type: boolean
          example: true
          description: 'Phim mi·ªÖn ph√≠ hay kh√¥ng'
        price_display:
          type: string
          example: 'Mi·ªÖn ph√≠'
          description: 'Hi·ªÉn th·ªã gi√° ƒë·ªãnh d·∫°ng'
        view_count:
          type: integer
          example: 15420
          description: 'S·ªë l∆∞·ª£t xem'
        favorite_count:
          type: integer
          example: 892
          description: 'S·ªë l∆∞·ª£t y√™u th√≠ch'
        rating:
          type: number
          format: float
          example: 4.6
          description: 'ƒê√°nh gi√° trung b√¨nh (0-5)'
        total_ratings:
          type: integer
          example: 1250
          description: 'T·ªïng s·ªë ƒë√°nh gi√°'
        total_episodes:
          type: integer
          example: 12
          description: 'T·ªïng s·ªë t·∫≠p'
        genres:
          type: array
          items:
            type: string
          example:
            - 'T√¨nh c·∫£m'
            - Drama
          description: 'Danh s√°ch th·ªÉ lo·∫°i (t·ªëi ƒëa 3)'
    PaginationInfo:
      type: object
      description: 'üìÑ Th√¥ng tin ph√¢n trang cho FlatList infinite scroll'
      properties:
        current_page:
          type: integer
          example: 1
          description: 'Trang hi·ªán t·∫°i'
        total_pages:
          type: integer
          example: 5
          description: 'T·ªïng s·ªë trang'
        total_items:
          type: integer
          example: 89
          description: 'T·ªïng s·ªë phim'
        items_per_page:
          type: integer
          example: 20
          description: 'S·ªë phim m·ªói trang'
        has_next:
          type: boolean
          example: true
          description: 'C√≥ trang ti·∫øp theo kh√¥ng'
        has_prev:
          type: boolean
          example: false
          description: 'C√≥ trang tr∆∞·ªõc kh√¥ng'
    SearchInfo:
      type: object
      description: 'üîç Th√¥ng tin t√¨m ki·∫øm v√† filter ƒë√£ √°p d·ª•ng'
      properties:
        keyword:
          type: string
          nullable: true
          example: avatar
          description: 'T·ª´ kh√≥a t√¨m ki·∫øm'
        filters:
          type: object
          properties:
            genre:
              type: string
              nullable: true
              example: 6847d080101e640d01a0c37f
              description: 'ID th·ªÉ lo·∫°i ƒë√£ l·ªçc'
            movie_type:
              type: string
              nullable: true
              example: 'Phim l·∫ª'
              description: 'Lo·∫°i phim ƒë√£ l·ªçc'
            is_free:
              type: string
              nullable: true
              example: 'true'
              description: 'Filter mi·ªÖn ph√≠'
            sort:
              type: string
              example: phobien
              description: 'C√°ch s·∫Øp x·∫øp ƒë√£ √°p d·ª•ng'
    VideoStreamResponse:
      type: object
      description: 'üé¨ Schema for Cloudflare Stream video response'
      properties:
        status:
          type: string
          example: success
        data:
          type: object
          properties:
            videoId:
              type: string
              example: 675a1234567890abcdef1234
              description: 'Episode ID ho·∫∑c Movie ID'
            streamUid:
              type: string
              example: a1b2c3d4e5f6789012345678
              description: 'Cloudflare Stream UID'
            type:
              type: string
              example: cloudflare-stream
              description: 'Lo·∫°i streaming service'
            movie:
              type: object
              properties:
                _id:
                  type: string
                title:
                  type: string
                  example: 'The Batman 2024'
                type:
                  type: string
                  example: 'Phim b·ªô'
            episode:
              type: object
              nullable: true
              properties:
                _id:
                  type: string
                title:
                  type: string
                  example: 'T·∫≠p 1: Kh·ªüi ƒë·∫ßu'
                number:
                  type: integer
                  example: 1
            stream:
              type: object
              properties:
                urls:
                  type: object
                  properties: {hls: {type: string, example: 'https://customer-account.cloudflarestream.com/uid/manifest/video.m3u8', description: 'HLS streaming URL cho mobile/iOS'}, dash: {type: string, example: 'https://customer-account.cloudflarestream.com/uid/manifest/video.mpd', description: 'DASH streaming URL cho web'}, mp4: {type: object, properties: {auto: {type: string, example: 'https://customer-account.cloudflarestream.com/uid/manifest/video.mp4'}, 360p: {type: string}, 480p: {type: string}, 720p: {type: string}, 1080p: {type: string}}}, thumbnail: {type: string, nullable: true, example: 'https://customer-account.cloudflarestream.com/uid/thumbnails/thumbnail.jpg', description: 'Auto-generated thumbnail'}, preview: {type: string, example: 'https://customer-account.cloudflarestream.com/uid/thumbnails/thumbnail.jpg?time=1s'}}
                recommended:
                  type: object
                  description: 'URLs ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t d·ª±a tr√™n device/platform'
                  properties: {mobile: {type: string, description: 'HLS URL cho mobile'}, web: {type: string, description: 'DASH URL cho web browsers'}, fallback: {type: string, description: 'MP4 URL cho compatibility'}}
                duration:
                  type: number
                  example: 3600
                  description: 'Video duration in seconds'
                size:
                  type: number
                  example: 524288000
                  description: 'File size in bytes'
                created:
                  type: string
                  format: date-time
                  description: 'Upload timestamp'
                processingStatus:
                  type: string
                  example: ready
                  description: 'Video processing status'
    CloudflareImageResponse:
      type: object
      description: 'üñºÔ∏è Schema for Cloudflare Images upload response'
      properties:
        status:
          type: string
          example: success
        message:
          type: string
          example: '·∫¢nh ƒë√£ ƒë∆∞·ª£c upload th√†nh c√¥ng l√™n Cloudflare Images'
        data:
          type: object
          properties:
            id:
              type: string
              example: 2cdc28f0-017a-49c4-9ed7-87056c83901f
              description: 'Cloudflare Images ID'
            filename:
              type: string
              example: avatar.jpg
              description: 'Original filename'
            uploaded:
              type: string
              format: date-time
              description: 'Upload timestamp'
            urls:
              type: object
              properties:
                original:
                  type: string
                  example: 'https://imagedelivery.net/account/id/public'
                  description: 'Original size image'
                avatar:
                  type: string
                  example: 'https://imagedelivery.net/account/id/avatar'
                  description: '150x150px optimized for avatars'
                thumbnail:
                  type: string
                  example: 'https://imagedelivery.net/account/id/thumb'
                  description: '300x300px thumbnail'
                medium:
                  type: string
                  example: 'https://imagedelivery.net/account/id/medium'
                  description: '800x600px medium size'
            recommendedUrl:
              type: string
              description: 'URL ƒë∆∞·ª£c ƒë·ªÅ xu·∫•t d·ª±a tr√™n variant requested'
    CloudflareVideoUploadResponse:
      type: object
      description: 'üé¨ Schema for Cloudflare Stream video upload response'
      properties:
        status:
          type: string
          example: success
        message:
          type: string
          example: 'Video ƒë√£ ƒë∆∞·ª£c upload th√†nh c√¥ng l√™n Cloudflare Stream'
        data:
          type: object
          properties:
            episodeId:
              type: string
              example: 675a1234567890abcdef1234
              description: 'Episode ID li√™n k·∫øt v·ªõi video'
            streamUid:
              type: string
              example: a1b2c3d4e5f6789012345678
              description: 'Cloudflare Stream UID'
            uploadStatus:
              type: string
              enum:
                - ready
                - inprogress
                - error
              example: inprogress
              description: 'Tr·∫°ng th√°i upload/processing'
            playback:
              type: object
              nullable: true
              description: 'Playback URLs (available when status=ready)'
              properties:
                hls:
                  type: string
                dash:
                  type: string
                mp4:
                  type: object
            thumbnail:
              type: string
              nullable: true
              example: 'https://customer-account.cloudflarestream.com/uid/thumbnails/thumbnail.jpg'
              description: 'Auto-generated thumbnail'
            processingStatus:
              type: string
              example: ready
              description: 'Video processing status'
    CreateRentalRequest:
      type: object
      required:
        - userId
        - movieId
        - rentalType
      properties:
        userId:
          type: string
          example: 507f1f77bcf86cd799439011
          description: 'ID c·ªßa user thu√™ phim'
        movieId:
          type: string
          example: 683d94d3602b36157f1c7af3
          description: 'ID c·ªßa phim c·∫ßn thu√™'
        rentalType:
          type: string
          enum:
            - 48h
            - 30d
          example: 48h
          description: 'Lo·∫°i g√≥i thu√™: 48h (30% gi√° phim) ho·∫∑c 30d (50% gi√° phim)'
    CreateRentalResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 'T·∫°o order thu√™ phim th√†nh c√¥ng'
        data:
          type: object
          properties:
            orderCode:
              type: string
              example: '1736758123456'
              description: 'M√£ ƒë∆°n h√†ng PayOS'
            checkoutUrl:
              type: string
              example: 'https://pay.payos.vn/web/a1b2c3d4'
              description: 'URL checkout PayOS'
            amount:
              type: number
              example: 15000
              description: 'S·ªë ti·ªÅn c·∫ßn thanh to√°n (VNƒê)'
            rentalType:
              type: string
              example: 48h
            movieTitle:
              type: string
              example: 'Avatar: The Way of Water'
            qrCode:
              type: string
              example: 00020101021238570010A000000727012800069704...QR_CODE_DATA
              description: 'QR Code string cho thanh to√°n'
            paymentInfo:
              type: object
              properties:
                bin:
                  type: string
                  example: '970436'
                accountNumber:
                  type: string
                  example: '12345678901'
                accountName:
                  type: string
                  example: 'CONG TY TNHH ABC'
    ConfirmPaymentRequest:
      type: object
      required:
        - orderCode
        - userId
      properties:
        orderCode:
          type: string
          example: '1736758123456'
          description: 'M√£ ƒë∆°n h√†ng PayOS'
        userId:
          type: string
          example: 507f1f77bcf86cd799439011
          description: 'ID c·ªßa user'
    ConfirmPaymentResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 'Thu√™ phim th√†nh c√¥ng! B·∫°n c√≥ th·ªÉ xem phim trong 48 gi·ªù.'
        data:
          $ref: '#/components/schemas/RentalInfo'
    RentalAccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            hasAccess:
              type: boolean
              example: true
              description: 'User c√≥ quy·ªÅn xem phim hay kh√¥ng'
            rental:
              $ref: '#/components/schemas/RentalInfo'
              nullable: true
            remainingTime:
              type: number
              example: 167400000
              description: 'Th·ªùi gian c√≤n l·∫°i (milliseconds)'
            remainingHours:
              type: number
              example: 47
              description: 'S·ªë gi·ªù c√≤n l·∫°i'
            remainingDays:
              type: number
              example: 2
              description: 'S·ªë ng√†y c√≤n l·∫°i'
            message:
              type: string
              example: 'C√≤n l·∫°i 47 gi·ªù'
    RentalHistoryResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 'L·∫•y l·ªãch s·ª≠ thu√™ phim th√†nh c√¥ng'
        data:
          type: object
          properties:
            rentals:
              type: array
              items:
                $ref: '#/components/schemas/RentalInfo'
            pagination:
              type: object
              properties:
                currentPage:
                  type: integer
                  example: 1
                totalPages:
                  type: integer
                  example: 3
                total:
                  type: integer
                  example: 25
                hasNext:
                  type: boolean
                  example: true
                hasPrev:
                  type: boolean
                  example: false
    RentalInfo:
      type: object
      properties:
        _id:
          type: string
          example: 64f1a2b3c4d5e6f7g8h9i0j1
        userId:
          type: string
          example: 507f1f77bcf86cd799439011
        movieId:
          type: object
          properties:
            _id:
              type: string
              example: 683d94d3602b36157f1c7af3
            title:
              type: string
              example: 'Avatar: The Way of Water'
            poster:
              type: string
              example: 'https://imagedelivery.net/.../poster.jpg'
            duration:
              type: number
              example: 120
        paymentId:
          type: object
          properties:
            _id:
              type: string
            amount:
              type: number
              example: 15000
            orderCode:
              type: string
              example: '1736758123456'
        rentalType:
          type: string
          enum:
            - 48h
            - 30d
          example: 48h
        status:
          type: string
          enum:
            - active
            - expired
            - cancelled
          example: active
        startTime:
          type: string
          format: date-time
          example: '2024-01-15T10:30:00.000Z'
        endTime:
          type: string
          format: date-time
          example: '2024-01-17T10:30:00.000Z'
        accessCount:
          type: number
          example: 5
          description: 'S·ªë l·∫ßn user ƒë√£ truy c·∫≠p xem phim'
        lastAccess:
          type: string
          format: date-time
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    RevenueStatsResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 'L·∫•y th·ªëng k√™ doanh thu th√†nh c√¥ng'
        data:
          type: object
          properties:
            summary:
              type: object
              properties:
                totalRevenue:
                  type: number
                  example: 5420000
                  description: 'T·ªïng doanh thu (VNƒê)'
                totalRentals:
                  type: number
                  example: 287
                  description: 'T·ªïng s·ªë l∆∞·ª£t thu√™'
                averageRevenuePerRental:
                  type: number
                  example: 18884
                  description: 'Doanh thu trung b√¨nh m·ªói l∆∞·ª£t thu√™'
            dailyStats:
              type: array
              items:
                type: object
                properties:
                  date: {type: string, format: date, example: '2024-01-15'}
                  revenue: {type: number, example: 125000}
                  rentals: {type: number, example: 8}
                  rentalTypes: {type: object, properties: {48h: {type: number, example: 5}, 30d: {type: number, example: 3}}}
    PopularRentalsResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 'L·∫•y danh s√°ch phim ph·ªï bi·∫øn th√†nh c√¥ng'
        data:
          type: array
          items:
            type: object
            properties:
              movieId:
                type: string
                example: 683d94d3602b36157f1c7af3
              title:
                type: string
                example: 'Avatar: The Way of Water'
              poster:
                type: string
                example: 'https://imagedelivery.net/.../poster.jpg'
              totalRentals:
                type: number
                example: 45
                description: 'T·ªïng s·ªë l∆∞·ª£t thu√™'
              revenue:
                type: number
                example: 850000
                description: 'Doanh thu t·ª´ phim n√†y'
              rentalTypes:
                type: object
                properties:
                  48h: {type: number, example: 30}
                  30d: {type: number, example: 15}
    CronStatusResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 'L·∫•y tr·∫°ng th√°i cron jobs th√†nh c√¥ng'
        data:
          type: object
          properties:
            expiredRentalsCheck:
              type: object
              properties:
                running:
                  type: boolean
                  example: false
                scheduled:
                  type: boolean
                  example: false
            expiringNotifications:
              type: object
              properties:
                running:
                  type: boolean
                  example: false
                scheduled:
                  type: boolean
                  example: false
            cleanupOldRentals:
              type: object
              properties:
                running:
                  type: boolean
                  example: false
                scheduled:
                  type: boolean
                  example: false
            dailyStatsGeneration:
              type: object
              properties:
                running:
                  type: boolean
                  example: false
                scheduled:
                  type: boolean
                  example: false
    ManualCheckResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
          example: 'Manual check ho√†n th√†nh'
        data:
          type: object
          properties:
            success:
              type: boolean
              example: true
            expiredCount:
              type: number
              example: 3
              description: 'S·ªë rental ƒë√£ b·ªã expire'
            expiringCount:
              type: number
              example: 5
              description: 'S·ªë rental s·∫Øp h·∫øt h·∫°n'
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: query
      name: userId
      description: 'User ID for authentication'
